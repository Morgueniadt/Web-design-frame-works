(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,function(e,t){e.exports={shortenString:function(e,t){return e.length>t?"".concat(e.slice(0,t-3),"..."):e},sizeThumbnails:function(e,t,a){var i=a/t;if(e<1/i)return Math.min(128,Math.max(32,a/e));var n=Math.sqrt(e*i),r=Math.ceil(n),s=Math.ceil(r/i),o=Math.floor(n),l=Math.ceil(e/o);return Math.min(128,Math.max(32,t/Math.min(s,l)))},formatReleaseDate:function(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"];if("year"===e.release_date_precision)return e.release_date;if("month"===e.release_date_precision){var a=+e.release_date.slice(5,7),i=e.release_date.slice(0,4);return"".concat(t[a-1]," ").concat(i)}if("day"===e.release_date_precision){var n=+e.release_date.slice(8,10),r=+e.release_date.slice(5,7),s=e.release_date.slice(0,4);return"".concat(t[r-1]," ").concat(n,", ").concat(s)}},epochTimeReleaseDate:function(e){if("year"===e.release_date_precision)return new Date(JSON.stringify(e.release_date));if("month"===e.release_date_precision){var t=+e.release_date.slice(5,7),a=+e.release_date.slice(0,4);return new Date(JSON.stringify(a),JSON.stringify(t-1))}if("day"===e.release_date_precision){var i=+e.release_date.slice(8,10),n=+e.release_date.slice(5,7),r=+e.release_date.slice(0,4);return new Date(JSON.stringify(r),JSON.stringify(n-1),JSON.stringify(i))}},getRandomInt:function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e},addCommas:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},parseWindowLocationHash:function(){return window.location.hash.substr(1).split("&").reduce(function(e,t){var a=t.split("=");return e[a[0]]=a[1],e},{})},getEntityFromLink:function(e){var t,a=["artist","playlist","track","album"],i={};if(e.startsWith("https://open.spotify.com/")){if(t=e.match(/\/(\w+)\/[^\/]*$/)[1],a.indexOf(t)<0)return!1;i.entity=t;var n=new RegExp("".concat(t,"/(.{22})"));return i.id=e.match(n)[1],i}return!!e.startsWith("spotify:")&&(t=e.match(/:(\w+):[^:]*$/)[1],!(a.indexOf(t)<0)&&(i.entity=t,i.id=e.slice(-22),i))},getPosition:function(e){for(var t=0,a=0;e;)t+=e.offsetLeft-e.scrollLeft+e.clientLeft,a+=e.offsetTop-e.scrollTop+e.clientTop,e=e.offsetParent;return{x:t,y:a}},generateRandomString:function(e){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<e;i++)t+=a.charAt(Math.floor(Math.random()*a.length));return t}}},,,,function(e,t,a){e.exports=a.p+"static/media/AnnotationLine.acd5897a.svg"},,,,function(e,t,a){e.exports=a.p+"static/media/icon-magic.bd8e5088.svg"},,,,,function(e,t,a){e.exports=a.p+"static/media/everynoise-genres.3d03bd3b.csv"},function(e,t,a){e.exports=a.p+"static/media/cursor-pointer.833dd682.svg"},function(e,t,a){e.exports=a.p+"static/media/cursor-default.6849b043.svg"},function(e,t,a){e.exports=a.p+"static/media/add-plus-sign.fcbacaf9.svg"},,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){e.exports=a.p+"static/media/spotify-countries.8ae8ca3b.csv"},function(e,t,a){e.exports=a.p+"static/media/play-button.899e11ee.svg"},function(e,t,a){e.exports=a.p+"static/media/pause-button.4790a5f7.svg"},function(e,t,a){e.exports=a.p+"static/media/icon-arrow-up-right-white.02961ea4.svg"},function(e,t,a){e.exports=a.p+"static/media/icon-plus-white.855c2610.svg"},function(e,t,a){e.exports=a.p+"static/media/icon-add-to-playlist-white.9d956675.svg"},function(e,t,a){e.exports=a.p+"static/media/icon-check-white.4edf0a8b.svg"},function(e,t,a){e.exports=a.p+"static/media/icon-refresh-bk.61770d7d.svg"},function(e,t,a){e.exports=a.p+"static/media/close-button.2d8ed870.svg"},function(e,t,a){e.exports=a.p+"static/media/close-button-white.af2ca92f.svg"},function(e,t,a){e.exports=a.p+"static/media/gear-icon-white.c267d185.svg"},function(e,t,a){e.exports=a.p+"static/media/browser-chrome.bebbefed.png"},function(e,t,a){e.exports=a.p+"static/media/dq-promo.d66a23b7.mp4"},function(e,t,a){e.exports=a.p+"static/media/dq-promo.8d999945.m4v"},,function(e,t,a){e.exports=a(81)},,,,,function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.r(t);var i=a(0),n=a.n(i),r=a(13),s=a.n(r),o=(a(59),a(2)),l=a(3),c=a(6),d=a(4),u=a(5),m=a(1),p=(a(61),a(62),a(14)),h=a(7),v=a.n(h),f=a(8),y=a.n(f),g=a(10),k=a(16),w=a(20),b=a.n(w),E=a(39),P=a.n(E),S="".concat(window.location.origin,"/"),O=["playlist-read-private","playlist-read-collaborative","playlist-modify-public","playlist-modify-private","user-follow-read","user-follow-modify","user-library-read","user-library-modify","user-read-birthdate","user-read-email","user-read-private","streaming","user-top-read"],T={"own profile":"me","own playlists":"me/playlists","user playlists":"users/$user/playlists",track:"tracks/$id",tracks:"tracks","check if saved track":"me/tracks/contains","save track":"me/tracks",artist:"artists/$id","related artists":"artists/$id/related-artists","artist top tracks":"artists/$id/top-tracks","artist albums":"artists/$id/albums","check if following artist":"me/following/contains","follow artist":"me/following",album:"albums/$id","album tracks":"albums/$id/tracks","check if saved album":"me/albums/contains","save album":"me/albums","multiple albums":"albums",playlist:"playlists/$id","check if follow playlist":"playlists/$id/followers/contains","follow playlist":"playlists/$id/followers","playlist tracks":"playlists/$id/tracks","track audio features":"audio-features","create playlist":"users/$user/playlists","add to playlist":"playlists/$id/tracks",recommendations:"recommendations",search:"search",categories:"browse/categories","category playlists":"browse/categories/$id/playlists","featured playlists":"browse/featured-playlists","saved albums":"me/albums","saved tracks":"me/tracks","top tracks":"me/top/tracks","top artists":"me/top/artists","followed artists":"me/following","new releases":"browse/new-releases"},A={ownPlaylists:!0,userPlaylists:!0},_={default:864e5,ownPlaylists:72e5},C=function(){function e(t){var a=this;Object(o.a)(this,e);var i=this;this.accessToken=i.authorize(),this.accessToken&&(this.updateCurrentlyPlaying=t,this.cache={},window.onSpotifyWebPlaybackSDKReady=function(){a.initializePlaybackSDK()},this.modifyPlaylist=this.modifyPlaylist.bind(this),this.getCached=this.getCached.bind(this),this.setCached=this.setCached.bind(this),i.callsMade=0,setInterval(function(){i.callsMade>0&&(i.callsMade=0)},1e3),this.APIready=new Promise(function(e){i.getEntity("own profile","self",null,null,!0).then(function(t){i.market=t.country,i.product=t.product,window.product=t.product,"premium"!==i.product&&(window.playerError=!0),e(!0)})}))}return Object(l.a)(e,[{key:"authorize",value:function(){var e=Object(h.parseWindowLocationHash)(),t=e.access_token,a=localStorage.getItem("spotify_auth_state");if(e.error)alert("Error: ".concat(e.error)),this.accessHasUpdated(null);else{if(t&&e.state===a){var i=e.expires_in?parseInt(e.expires_in,10):3600;return localStorage.setItem("accessToken",t),localStorage.setItem("accessExpires",Date.now()+1e3*i),window.history.pushState({},"Discover Quickly","/"),t}if(t&&e.state!==a)console.log("Error: access state invalid");else if(localStorage.getItem("accessToken")){if(localStorage.getItem("accessExpires")>Date.now()+12e5)return localStorage.getItem("accessToken")}}return this.authorizeOnSpotify(),null}},{key:"authorizeOnSpotify",value:function(){var e=Object(h.generateRandomString)(16);localStorage.setItem("spotify_auth_state",e),window.location.href=encodeURI("https://accounts.spotify.com/authorize?client_id=".concat("155b87449b11484bb1a1c93a618b7a21","&scope=").concat(O.join(" "),"&response_type=token&redirect_uri=").concat(S,"&state=").concat(e))}},{key:"getCached",value:function(e,t){var a=this.makeCacheKey(e,t);if(!A[e])return this.cache[a];var i=localStorage.getItem(a);if(i){i=JSON.parse(i);var n=_[e]?_[e]:_.default;if(i.timestamp>Date.now()-n)return i.value;localStorage.removeItem(a)}return null}},{key:"setCached",value:function(e,t,a){var i=this.makeCacheKey(e,t);A[e]?localStorage.setItem(i,JSON.stringify({value:a,timestamp:Date.now()})):this.cache[i]=a}},{key:"invalidateCache",value:function(e,t){if("all"!==e){var a=this.makeCacheKey(e,t);A[e]?localStorage.removeItem(a):delete this.cache[a]}else localStorage.clear()}},{key:"makeCacheKey",value:function(e,t){return t||(t=""),e+t}},{key:"breakUpMultipleEntities",value:function(e,t,a){var i=[];return e.forEach(function(e,n){n%a===0&&i.push([]),"album"===t||e&&e.track?i[Math.floor(n/a)].push("album"===t?e.id:e.track.id):"alchemyAlbums"!==t&&"artists"!==t&&"track"!==t||i[Math.floor(n/a)].push(e)}),i}},{key:"getEntity",value:function(){var e=Object(g.a)(y.a.mark(function e(t,a){var i,n,r,s,o=arguments;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=o.length>2&&void 0!==o[2]?o[2]:null,n=o.length>3&&void 0!==o[3]?o[3]:null,r=o.length>4&&void 0!==o[4]&&o[4],s=this,r){e.next=7;break}return e.next=7,s.APIready;case 7:return e.abrupt("return",new Promise(function(e,r){if("random artist"!==t){var o=s.getCached(t,a);if(o)return void e(o)}var l=function(i){Array.isArray(i)?i.forEach(function(e){s.setCached(t,e.id,e)}):s.setCached(t,a,i),e(i)},c=function(e){r(e)};if("own profile"===t&&s.fetchFromAPI("own profile",{},{}).then(l,c),"playlist"===t&&s.fetchFromAPI("own profile",{}).then(function(e){Promise.all([s.fetchFromAPI("playlist tracks",{id:a},{limit:100}),s.fetchFromAPI("playlist",{id:a}),s.fetchFromAPI("check if follow playlist",{id:a},{ids:e.id})]).then(function(e){var t=e[0];t.name=e[1].name,t.description=e[1].description,t.userFollowsPlaylist=e[2][0],t.main_img=e[1].images.length?e[1].images[0].url:"",t.items.forEach(function(e,t){return e.playlist_track_number=t}),t.items=t.items.filter(function(e){return e.track}),Promise.all(s.breakUpMultipleEntities(t.items,"track",100).map(function(e,t){return s.fetchFromAPI("track audio features",null,{ids:e.join(","),limit:100})})).then(function(e){var a=e.map(function(e){return e.audio_features}).reduce(function(e,t){return e.concat(t)},[]);t.items.forEach(function(e,t){return e.track.audio_features=a[t]}),l(t)})},c)}),"albumlist"===t)Promise.all(s.breakUpMultipleEntities(n,"album",20).map(function(e,t){return s.fetchFromAPI("multiple albums",null,{ids:e.join(","),limit:20})})).then(function(e){var t={},a=e.map(function(e){return e.albums}).reduce(function(e,t){return e.concat(t)},[]).filter(function(e){return!!e&&(!t[e.name]&&(t[e.name]=!0,!0))});a.forEach(function(e,t){return e.album_list_order=t}),l(a)},c);else if("album"===t)Promise.all([s.fetchFromAPI("album tracks",{id:a},{limit:50}),s.fetchFromAPI("album",{id:a}),s.fetchFromAPI("check if saved album",null,{ids:a})]).then(function(e){var t=e[1];t.tracks.items=e[0].items,t.userSavedAlbum=e[2][0],Promise.all(t.artists.map(function(e){return s.getEntity("artistShallow",e.id)})).then(function(e){t.artists=e,l(t)},c)});else if("artist"===t)Promise.all([s.fetchFromAPI("artist",{id:a}),s.fetchFromAPI("artist top tracks",{id:a}),s.fetchFromAPI("artist albums",{id:a},{limit:50}),s.fetchFromAPI("related artists",{id:a}),s.fetchFromAPI("check if following artist",null,{type:"artist",ids:a})]).then(function(e){var t=e[0];t.topTracks=e[1].tracks;var a=e[3].artists;t.userFollowsArtist=e[4][0],Promise.all(s.breakUpMultipleEntities(e[2].items,"album",20).map(function(e,t){return s.fetchFromAPI("multiple albums",null,{ids:e.join(","),limit:20})})).then(function(e){var i={};t.albums=e.map(function(e){return e.albums}).reduce(function(e,t){return e.concat(t)},[]).filter(function(e){return!!e&&(!i[e.name]&&(i[e.name]=!0,!0))}),Promise.all(a.slice(0,window.settings.listLimit).map(function(e){return s.getEntity("artistShallow",e.id)})).then(function(e){t.relatedArtists=e,s.fetchFromAPI("search",null,{q:'"this is '.concat(t.name,'"'),type:"playlist",limit:50}).then(function(e){var a=e.playlists.items.filter(function(e){return(e.name.toLowerCase()==="this is ".concat(t.name.toLowerCase())||e.name.toLowerCase()==="this is: ".concat(t.name.toLowerCase()))&&"spotify"===e.owner.id});a.length?(t.this_is={},t.this_is.images=a[0].images,t.this_is.playlist_id=a[0].id,s.fetchFromAPI("playlist tracks",{id:a[0].id},{limit:100}).then(function(e){t.this_is.preview_track=e.items.length?e.items[0]:null,l(t)})):(t.this_is=null,l(t))})})})},c);else if("artistShallow"===t)Promise.all([s.fetchFromAPI("artist",{id:a}),s.fetchFromAPI("artist top tracks",{id:a})]).then(function(e){var t=e[0];t.topTracks=e[1].tracks,l(t)},c);else if("track"===t)Promise.all([s.fetchFromAPI("track",{id:a}),s.fetchFromAPI("check if saved track",null,{ids:a})]).then(function(e){var t=e[0];t.userSavedTrack=e[1][0],Promise.all(t.artists.map(function(e){return s.getEntity("artistShallow",e.id)})).then(function(e){t.artists=e,l(t)},c)});else if("trackShallow"===t)Array.isArray(a)?Promise.all(s.breakUpMultipleEntities(a,"track",50).map(function(e){return s.fetchFromAPI("tracks",null,{ids:e.join(",")})})).then(function(e){var t=e.map(function(e){return e.tracks}).reduce(function(e,t){return e.concat(t)},[]);l(t)},c):s.fetchFromAPI("track",{id:a}).then(l,c);else if("ownPlaylists"===t)s.fetchFromAPI("own playlists",{},{limit:50}).then(function(e){var t=/users\/(.*)\/playlists/.exec(e.href),a=t&&t.length>1?t[1]:null;e.items.forEach(function(e){e.canModify=e.owner.id===a||e.collaborative}),l(e)},c);else if("userPlaylists"===t)s.fetchFromAPI("user playlists",{user:a},{limit:50}).then(l,c);else if("categories"===t){var d=6e4*(new Date).getTimezoneOffset(),u=new Date(Date.now()-d).toISOString().slice(0,19);s.fetchFromAPI("categories",{},{limit:50,country:s.market}).then(function(e){Promise.all([s.fetchFromAPI("featured playlists",{},{limit:50,country:s.market,timestamp:u})].concat(e.categories.items.filter(function(e){return"regionalmexican"!==e.id}).filter(function(e){return"comedy_v2_podcast"!==e.id}).map(function(e){return s.fetchFromAPI("category playlists",{id:e.id},{limit:50,country:s.market})}))).then(function(t){var a={allPlaylists:[],byCategory:[]};t.forEach(function(t,i){var n=t.message?t.message:e.categories.items[i-1].name,r=t.playlists.items.map(function(e,t){return{id:e.id,name:e.name,category:n,sourceOrder:t}});a.byCategory.push({id:"category-".concat(n),name:n,items:r,sourceOrder:i}),a.allPlaylists=a.allPlaylists.concat(r)}),l(a)},c)},c)}else if("charts"===t)Object(k.a)(P.a).then(function(e){Promise.all(e.map(function(e){return s.fetchFromAPI("category playlists",{id:"toplists"},{limit:50,country:e.country.toUpperCase()},"GET",null,0,[],!1)})).then(function(e){var t=[];e.forEach(function(e){var a=e.playlists.items.filter(function(e){return e.name.includes("Viral 50")}),i=e.playlists.items.filter(function(e){return e.name.includes("Top 50")});a.forEach(function(e){t.map(function(e){return e.id}).includes(e.id)||(e.list_type="viral",t.push(e))}),i.forEach(function(e){t.map(function(e){return e.id}).includes(e.id)||(e.list_type="top",t.push(e))})}),l(t)},c)});else if("saved albums"===t)s.fetchFromAPI("saved albums",{},{limit:50}).then(l,c);else if("saved tracks"===t)s.fetchFromAPI("saved tracks",{},{limit:50}).then(function(e){Promise.all(s.breakUpMultipleEntities(e.items,"track",100).map(function(e,t){return s.fetchFromAPI("track audio features",null,{ids:e.join(","),limit:100})})).then(function(t){var a=t.map(function(e){return e.audio_features}).reduce(function(e,t){return e.concat(t)},[]);e.items.forEach(function(e,t){e.save_order=t,e.track.audio_features=a[t]}),l(e)})},c);else if("top tracks"===t){var m=["short_term","medium_term","long_term"];Promise.all(m.map(function(e){return s.fetchFromAPI("top tracks",{},{limit:50,time_range:e},"GET",null,0,[],!1)})).then(function(e){var t=[];e.forEach(function(e,a){e.items.length&&t.push(m[a])}),Promise.all(e.filter(function(e){return e.items.length}).map(function(e){var t=e.items.map(function(e){return e.id});return Promise.all([s.fetchFromAPI("tracks",null,{ids:t.join(",")}),s.fetchFromAPI("track audio features",null,{ids:t.join(","),limit:50})])})).then(function(e){var a={};e.forEach(function(e,i){e[0].tracks.forEach(function(t,a){t.audio_features=e[1].audio_features[a]}),a[t[i]]={items:e[0].tracks.map(function(e,t){return{track:e,affinity_rank:t}})}}),l(a)},c)})}else if("top artists"===t){var p=["short_term","medium_term","long_term"];Promise.all(p.map(function(e){return s.fetchFromAPI("top artists",{},{limit:50,time_range:e},"GET",null,0,[],!1)})).then(function(e){Promise.all(e.map(function(e){return Promise.all(e.items.map(function(e){return s.fetchFromAPI("artist top tracks",{id:e.id})}))})).then(function(t){e.forEach(function(e,a){e.items.forEach(function(e,i){e.affinity_rank=i,e.topTracks=t[a][i].tracks})});var a={};e.forEach(function(e,t){a[p[t]]=e}),l(a)})})}else if("followed artists"===t)s.fetchFromAPI("followed artists",{},{limit:50,type:"artist"}).then(function(t){t.items.length||e(t);var a=t.items.map(function(e){return e.id}),i=s.breakUpMultipleEntities(a,"artists",50);s.artificialPaginationForFollowedArtists(i,0,i.length,[]).then(function(a){t.items.forEach(function(e,t){e.topTracks=a[t].tracks}),t.items=t.items.filter(function(e){return e.topTracks.length}),e(t)},c)},c);else if("random artist"===t)s.fetchFromAPI("search",null,{q:"year:0000-9999",type:"artist",limit:50},"GET",null,Object(h.getRandomInt)(0,2e3)).then(function(e){l(e.artists.items[Object(h.getRandomInt)(0,49)].id)},c);else if("genrePlaylists"===t)Object(k.a)(b.a).then(function(e){l({items:e})},c);else if("search card"===t)s.fetchFromAPI("search",null,{q:"".concat(a,"*"),type:"album,artist,playlist,track",limit:50}).then(function(e){var t=[Promise.all(e.albums.items.slice(0,5).map(function(e){return s.fetchFromAPI("album tracks",{id:e.id},{limit:50})})),Promise.all(e.artists.items.slice(0,5).map(function(e){return s.fetchFromAPI("artist top tracks",{id:e.id})})),Promise.all(e.playlists.items.slice(0,5).map(function(e){return s.fetchFromAPI("playlist tracks",{id:e.id},{limit:100})}))];e.tracks.items.length&&t.push(s.fetchFromAPI("tracks",null,{ids:e.tracks.items.slice(0,5).map(function(e){return e.id})})),Promise.all(t).then(function(t){e.albums.items.slice(0,5).forEach(function(e,a){e.tracks={},e.tracks.items=t[0][a].items}),e.artists.items.slice(0,5).forEach(function(e,a){return e.topTracks=t[1][a].tracks}),e.playlists.items.slice(0,5).forEach(function(e,a){return e.tracks=t[2][a].items}),e.tracks.items.length&&e.tracks.items.slice(0,5).forEach(function(e,a){return e.preview_url=t[3].tracks[a].preview_url}),Object(k.a)(b.a).then(function(t){e.genres={items:t.filter(function(e){return e.name.includes(a.toLowerCase())}).sort(function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})},l(e)})},c)});else if("new releases"===t)s.fetchFromAPI("new releases",{},{limit:50}).then(l,c);else if("search"===t)s.fetchFromAPI("search",null,{q:"".concat(a,"*"),type:"album,artist,playlist,track",limit:50}).then(l,c);else if("recommendations"===t){if(!i)return;var v={limit:50};i.artists&&(v.seed_artists=i.artists.join(",")),i.tracks&&(v.seed_tracks=i.tracks.join(",")),i.genres&&(v.seed_genres=i.genres.join(",")),s.fetchFromAPI("recommendations",{},v).then(function(e){l({name:"Magic!",items:e.tracks.map(function(e,t){return{track:e,playlist_track_number:t}})})},c)}}));case 8:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"modifyPlaylist",value:function(){var e=Object(g.a)(y.a.mark(function e(t,a,i){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this,e.next=3,n.APIready;case 3:return e.abrupt("return",new Promise(function(e,r){var s,o=function(t){e(t)},l=function(e){r(e)};n.getEntity("own profile","self").then(function(e){"create playlist"===t?(s={name:i.name,public:!1},n.fetchFromAPI("create playlist",{user:e.id},null,"POST",s).then(function(e){i.tracks?(s={uris:i.tracks.filter(function(e){return e})},Promise.all(n.breakUpMultipleEntities(i.tracks.filter(function(e){return e}),"track",100).map(function(t){return n.fetchFromAPI("add to playlist",{id:e.id},null,"POST",{uris:t})})).then(o,l)):o(e)},function(e){l(e)})):"add to playlist"===t&&(s={uris:i.tracks},Promise.all(n.breakUpMultipleEntities(i.tracks.filter(function(e){return e}),"track",100).map(function(e){return n.fetchFromAPI("add to playlist",{id:a},null,"POST",{uris:e})})).then(o,l))})}));case 4:case"end":return e.stop()}},e,this)}));return function(t,a,i){return e.apply(this,arguments)}}()},{key:"saveOrFollowEntity",value:function(){var e=Object(g.a)(y.a.mark(function e(t,a,i){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this,e.next=3,n.APIready;case 3:return e.abrupt("return",new Promise(function(e,r){"playlist"===t?n.fetchFromAPI("follow playlist",{id:a},null,"PUT",{public:!1}).then(function(t){e(!0)}):"magic"===t?n.modifyPlaylist("create playlist",null,{name:a,tracks:i.map(function(e){return"spotify:track:".concat(e.track.id)})}).then(function(t){e(!0)}):"artist"===t?n.fetchFromAPI("follow artist",null,{type:"artist",ids:a},"PUT",{}).then(function(t){e(!0)}):"track"===t?Promise.all(n.breakUpMultipleEntities(a,"track",50).map(function(e,t){return n.fetchFromAPI("save track",null,{ids:e.join(",")},"PUT",{})})).then(function(t){e(!0)}):"album"===t&&n.fetchFromAPI("save album",null,{ids:a},"PUT",{}).then(function(t){e(!0)})}));case 4:case"end":return e.stop()}},e,this)}));return function(t,a,i){return e.apply(this,arguments)}}()},{key:"fetchFromAPI",value:function(){var e=Object(g.a)(y.a.mark(function e(t,a,i){var n,r,s,o,l,c,d=arguments;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>3&&void 0!==d[3]?d[3]:"GET",r=d.length>4&&void 0!==d[4]?d[4]:null,s=d.length>5&&void 0!==d[5]?d[5]:0,o=d.length>6&&void 0!==d[6]?d[6]:[],l=!(d.length>7&&void 0!==d[7])||d[7],c=this,e.abrupt("return",new Promise(function(e,d){var u=T[t];if(a)for(var m in a)u=u.replace("$".concat(m),a[m]);var p=i?Object.keys(i).map(function(e){return"".concat(e,"=").concat(i[e])}).join("&"):"?",h="".concat("https://api.spotify.com/v1/").concat(u,"?").concat(p,"&offset=").concat(s).concat(l?"&market=".concat(c.market):"");c.callsMade++;var v={Authorization:"Bearer ".concat(c.accessToken)};r&&(r=JSON.stringify(r).toString(),v["Content-Type"]="application/json");!function r(s){fetch(s).then(function(){var e=Object(g.a)(y.a.mark(function e(t){var a,i;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.text();case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return",{});case 5:return(i=JSON.parse(a)).headers=t.headers,e.abrupt("return",i);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).then(function(d){if(d.error)if(401===d.error.status)c.authorizeOnSpotify();else if(500===d.error.status)setTimeout(function(){r(s)},5e3);else if(429===d.error.status){var u=d.headers.get("Retry-After")?d.headers.get("Retry-After"):2;setTimeout(function(){r(s)},1e3*u)}else console.log("API Error: ".concat(d.error.message));else if("followed artists"===t)d.artists.cursors.after?e(c.fetchFromAPI(t,a,{type:"artist",limit:50,after:d.artists.cursors.after},n,null,d.offset+d.limit,o.concat(d.artists.items))):(d.items=o.concat(d.artists.items),e(d));else{var m="new releases"===t?d.albums:d;m.total>m.offset+m.limit?e(c.fetchFromAPI(t,a,i,n,null,m.offset+m.limit,o.concat(m.items),l)):(m.items=o.concat(m.items),m.items.forEach(function(e,t){e&&(e.sourceOrder=t)}),e(m))}},function(e){console.log(e),d(new Error("API error: ".concat(e)))})}(new Request(h,{method:n,headers:new Headers(v),body:r}))}));case 7:case"end":return e.stop()}},e,this)}));return function(t,a,i){return e.apply(this,arguments)}}()},{key:"artificialPaginationForFollowedArtists",value:function(){var e=Object(g.a)(y.a.mark(function e(t,a,i,n){var r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,e.abrupt("return",Promise.all(t[a].map(function(e){return r.fetchFromAPI("artist top tracks",{id:e})})).then(function(e){return a+=1,e=n.concat(e),a===i?Promise.resolve(e):Promise.resolve(r.artificialPaginationForFollowedArtists(t,a,i,e))}));case 2:case"end":return e.stop()}},e,this)}));return function(t,a,i,n){return e.apply(this,arguments)}}()},{key:"initializePlaybackSDK",value:function(){var e=this;window.Spotify&&(e.player=new window.Spotify.Player({name:"Discover Quickly",getOAuthToken:function(t){t(e.accessToken)}}),window.playerError=!1,e.player.addListener("initialization_error",function(e){var t=e.message;window.playerError=!0,console.log(t)}),e.player.addListener("authentication_error",function(e){var t=e.message;window.playerError=!0,console.log(t)}),e.player.addListener("account_error",function(e){var t=e.message;window.playerError=!0,console.log(t)}),e.player.addListener("playback_error",function(e){var t=e.message;window.playerError=!0,console.log(t)}),e.player.addListener("player_state_changed",function(t){var a=t&&!1===t.paused&&t.track_window?t.track_window.current_track.id:null,i=t&&0===t.position&&!0===t.paused;e.updateCurrentlyPlaying(a,i)}),e.player.addListener("ready",function(e){e.device_id}),e.player.addListener("not_ready",function(e){e.device_id}),e.player.connect())}},{key:"playTrack",value:function(e){var t=this;t.stopPreview();!function(a){a.spotify_uri;var i=a.playerInstance._options,n=i.getOAuthToken,r=i.id;n(function(a){fetch("https://api.spotify.com/v1/me/player/play?device_id=".concat(r),{method:"PUT",body:JSON.stringify({uris:[e]}).toString(),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.accessToken)}})})}({playerInstance:t.player,spotify_uri:e})}},{key:"pauseTrack",value:function(){var e=this;return this.player.getCurrentState().then(function(t){return t?new Promise(function(t,a){e.player.pause().then(function(){t()})}):null})}},{key:"startPreview",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;this.stopPreview(),this.audio=new Audio(e),this.audio.volume=a,this.audio.autoplay=!1;var i=this.audio.play();void 0!==i&&i.catch(function(e){}).then(function(){}),this.audio.onended=function(){t(!1)}}},{key:"startPreviewFromClick",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;this.audio&&!this.audio.paused||this.startPreview(e,t,a)}},{key:"stopPreview",value:function(){this.audio&&this.audio.pause()}}]),e}(),j=a(21),N=a.n(j),I=a(22),F=a.n(I),D=a(23),x=a.n(D),R=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.audio)("start preview",null,"https://p.scdn.co/mp3-preview/4ae009901001c1d12574dff38335dd93a3a9b586?cid=155b87449b11484bb1a1c93a618b7a21",0)}},{key:"render",value:function(){var e=this.props,t=e.handleClose,a=e.firstTime,i=n.a.createElement("div",null,n.a.createElement("div",{className:"modal-transparency ",onClick:t}),n.a.createElement("div",{className:"modal-container"},n.a.createElement("div",{className:"modal-body",style:{textAlign:"center"}},n.a.createElement("h1",{style:{marginBottom:"16px"}},"Put your headphones or speakers on."),n.a.createElement("h2",null,"This website plays (lots of) music."),n.a.createElement("div",{className:"modal-grid"},n.a.createElement("div",{style:{gridColumn:"1/2"}},n.a.createElement("img",{className:"modal-icon",alt:"cursor default",src:F.a}),n.a.createElement("div",{className:"modal-directive"},"Hover"),n.a.createElement("div",{className:"modal-directive-secondary"},"to listen")),n.a.createElement("div",{style:{gridColumn:"2/3"}},n.a.createElement("img",{className:"modal-icon",alt:"cursor pointer",src:N.a}),n.a.createElement("div",{className:"modal-directive"},"Click"),n.a.createElement("div",{className:"modal-directive-secondary"},"to dig deeper")),n.a.createElement("div",{style:{gridColumn:"3/4"}},n.a.createElement("img",{className:"modal-icon",alt:"add plus sign",src:x.a}),n.a.createElement("div",{className:"modal-directive"},"Save"),n.a.createElement("div",{className:"modal-directive-secondary"},"to build your collection"))),n.a.createElement("p",{style:{textAlign:"left",margin:"16px auto",width:"525px"}},"Start with ",n.a.createElement("strong",null,"something you know"),", like your top tracks or favorite playlist.",n.a.createElement("br",null),"Or a ",n.a.createElement("strong",null,"Spotify recommendation"),", like Discover Weekly or Release Radar.",n.a.createElement("br",null),"Or a ",n.a.createElement("strong",null,"completely random")," genre or artist... whatever strikes your fancy."),n.a.createElement("p",{style:{textAlign:"left",margin:"16px auto",width:"525px"}},n.a.createElement("span",{className:"modal-pink"},"Then follow your ears to find new music you love.")),n.a.createElement("p",{style:{textAlign:"center"}},n.a.createElement("button",{className:"primaryButton",onClick:t},"Jump in"))))),r=n.a.createElement("div",null,n.a.createElement("div",{className:"modal-transparency",onClick:t}),n.a.createElement("div",{className:"modal-container"},n.a.createElement("div",{className:"modal-body",style:{textAlign:"center"}},n.a.createElement("h1",{style:{marginBottom:"16px"}},"Welcome back!"),n.a.createElement("h2",null,"Just a reminder... this website plays (lots of) music."),n.a.createElement("div",{className:"modal-grid"},n.a.createElement("div",{style:{gridColumn:"1/2"}},n.a.createElement("img",{className:"modal-icon",alt:"cursor default",src:F.a}),n.a.createElement("div",{className:"modal-directive"},"Hover"),n.a.createElement("div",{className:"modal-directive-secondary"},"to listen")),n.a.createElement("div",{style:{gridColumn:"2/3"}},n.a.createElement("img",{className:"modal-icon",alt:"cursor pointer",src:N.a}),n.a.createElement("div",{className:"modal-directive"},"Click"),n.a.createElement("div",{className:"modal-directive-secondary"},"to dig deeper")),n.a.createElement("div",{style:{gridColumn:"3/4"}},n.a.createElement("img",{className:"modal-icon",alt:"add plus sign",src:x.a}),n.a.createElement("div",{className:"modal-directive"},"Save"),n.a.createElement("div",{className:"modal-directive-secondary"},"to build your collection"))),n.a.createElement("p",{style:{textAlign:"left",margin:"16px auto",width:"525px"}},"Start with ",n.a.createElement("strong",null,"something you know"),", like your top tracks or favorite playlist.",n.a.createElement("br",null),"Or a ",n.a.createElement("strong",null,"Spotify recommendation"),", like Discover Weekly or Release Radar.",n.a.createElement("br",null),"Or a ",n.a.createElement("strong",null,"completely random")," genre or artist... whatever strikes your fancy."),n.a.createElement("p",{style:{textAlign:"left",margin:"16px auto",width:"525px"}},n.a.createElement("span",{className:"modal-pink"},"Then follow your ears to find new music you love.")),n.a.createElement("p",{style:{textAlign:"center"}},n.a.createElement("button",{className:"primaryButton",onClick:t},"Jump in")))));return a?i:r}}]),t}(i.Component),L=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){window.gtag("event","viewed about",{event_category:"navigation"})}},{key:"render",value:function(){var e=this.props.handleClose;return n.a.createElement("div",null,n.a.createElement("div",{className:"modal-transparency",onClick:e}),n.a.createElement("div",{className:"modal-container"},n.a.createElement("div",{className:"modal-body"},n.a.createElement("h1",null,"About this project"),n.a.createElement("p",null,n.a.createElement("strong",null,"What if there were an interface designed specifically for discovering new music?")),n.a.createElement("p",null,"As music lovers, we're always looking for new music from as many sources as possible: Spotify recommendations and playlists, friends, family, music blogs, and holy shit, what is that amazing song playing right now over the bodega speakers? We realized: maybe we could build a tool to expedite and expand the pursuit of our next favorite song or artist obsession. "),n.a.createElement("p",null,"We can often tell if we're intrigued by a song within a second or two of listening. The core of Discover Quickly is built around that idea. ",n.a.createElement("strong",null,"Start anywhere"),", depending on your mood: music you already love, today's top hits, or something random. Then ",n.a.createElement("strong",null,"hover over images")," to sample tracks immediately. If you maybe like what you hear, then click to follow your ears down the rabbit hole of your musical taste. ",n.a.createElement("strong",null,"Save, follow, or playlist")," anything you like. If you're a Spotify subscriber, you can listen to full tracks from this page, but we see this mainly as your curation tool. It's your supercharged record shop for browsing: collect stuff you might like, and then listen deeply later."),n.a.createElement("p",null,"Discover Quickly is ",n.a.createElement("em",null,"not")," an official Spotify project, but it is powered by the excellent public ",n.a.createElement("a",{href:"https://developer.spotify.com/"},"Spotify Web API"),", which exposes music metadata, playback and recommendation endpoints."),n.a.createElement("p",null,"While building Discover Quickly, we've opened our ears to genres and artists previously unexplored (for Aliza: vintage J-Pop; for Edward: chamber psychedelic). It's been hard to focus on building because we've been so distracted by new music! But here it is, ready for you to try."),n.a.createElement("p",null,"Let us know what you discover!"),n.a.createElement("p",null,"- ",n.a.createElement("a",{href:"https://twitter.com/alizauf"},"Aliza")," & ",n.a.createElement("a",{href:"https://twitter.com/edwrdlee"},"Edward"))),n.a.createElement("div",{className:"modal-footer"},n.a.createElement("button",{className:"primaryButton",onClick:e},"Back to the music!"))))}}]),t}(i.Component),M=a(11),z=a.n(M),Q=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.mode,t=[];if("feed"===e)t.push(n.a.createElement("div",{key:"explainer explainer-feed",className:"explainer explainer-feed"},n.a.createElement("img",{className:"dotted-line",src:z.a,alt:"Dotted line"}),"Hover on an image to preview, click to dive deeper"));else if("playback"===e)t.push(n.a.createElement("div",{key:"explainer explainer-playback",className:"explainer explainer-playback"},n.a.createElement("img",{className:"dotted-line",src:z.a,alt:"Dotted line"}),"Click anywhere to keep exploring"));else{if("queue"!==e)return"";t.push(n.a.createElement("div",{key:"explainer explainer-queue",className:"explainer explainer-queue"},n.a.createElement("img",{className:"dotted-line",src:z.a,alt:"Dotted line"}),"Save or playlist all the music you click on from up here...")),t.push(n.a.createElement("div",{key:"explainer explainer-card",className:"explainer explainer-card"},n.a.createElement("img",{className:"dotted-line",src:z.a,alt:"Dotted line"}),"...or add each discovery to Spotify right after you find it"))}return n.a.createElement("div",null,t)}}]),t}(i.Component),U=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={value:""},a.handleChange=a.handleChange.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){"search"===e.currentRootCategory&&"search"!==this.props.currentRootCategory&&""!==this.state.value&&this.setState({value:""})}},{key:"handleChange",value:function(e){var t=this;t.typeTimer&&clearTimeout(t.typeTimer);var a=e.target.value,i=this.state.value;t.setState({value:a}),t.typeTimer=setTimeout(function(){var e=Object(h.getEntityFromLink)(a);e?t.props.addToFeed(null,{type:e.entity,id:e.id}):t.props.addToFeed(null,{type:"search",id:a}),t.props.updateRoot("search",a,!1,i)},200),e.preventDefault()}},{key:"render",value:function(){return n.a.createElement("input",{className:"search-bar",type:"text",placeholder:"Search",value:this.state.value,onChange:this.handleChange})}}]),t}(n.a.Component),H=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;e.props.API.getEntity("genrePlaylists").then(function(t){e.setState({spotifyGenrePlaylists:t.items.sort(function(e,t){return e.name<t.name?-1:1})})})}},{key:"handleFeed",value:function(e){var t=this.props,a=t.addToFeed,i=t.updateRoot,n=t.discoverWeeklyId,r=t.releaseRadarId,s=this.state.spotifyGenrePlaylists,o=this;if(e)if("your playlists"===e)a(null,{type:"text list",id:"list-yourPlaylists"}),i("yourPlaylists",null);else if("saved albums"===e)a(null,{type:"saved albums",id:"Your Saved Albums"}),i("saved albums",null);else if("saved tracks"===e)a(null,{type:e,id:"saved_tracks"}),i("saved tracks",null);else if("top tracks"===e)a(null,{type:e,id:"top_tracks"}),i("top tracks",null);else if("top artists"===e)a(null,{type:e,id:"top_artists"}),i("top artists",null);else if("followed artists"===e)a(null,{type:e,id:"followed_artists"}),i("followed artists",null);else if("discover weekly"===e)a(null,{type:"playlist",id:n}),i("discover weekly",null);else if("release radar"===e)a(null,{type:"playlist",id:r}),i("release radar",null);else if("charts"===e)a(null,{type:"text list",id:"list-charts"}),i("charts",null);else if("spotifyPlaylists"===e)a(null,{type:"text list",id:"list-spotifyPlaylists"}),i("spotifyPlaylists",null);else if("genres"===e)a(null,{type:"text list",id:"list-genres"}),i("genres",null);else if("newReleases"===e)a(null,{type:"new releases",id:"New Releases"}),i("new releases",null);else if("random genre"===e){if(s){var l=Object(h.getRandomInt)(0,o.state.spotifyGenrePlaylists.length);o.props.addToFeed(null,{type:"playlist",id:o.state.spotifyGenrePlaylists[l].id}),o.props.updateRoot("random genre",null)}}else"random artist"===e&&o.props.API.getEntity("random artist").then(function(e){o.props.addToFeed(null,{type:"artist",id:e}),o.props.updateRoot("random artist",null)})}},{key:"render",value:function(){var e=this,t=this.props,a=t.currentRootCategory,i=t.discoverWeeklyId,r=t.releaseRadarId,s=t.API,o=t.updateRoot,l=t.addToFeed;return n.a.createElement("div",{className:"launchPad inverted"},n.a.createElement("div",{className:"launchPad-grid"},n.a.createElement("div",{style:{gridColumn:"1/2"}},n.a.createElement("div",{className:"launchPad-subgrid"},n.a.createElement("div",{className:"button option view-link ".concat("yourPlaylists"===a?"active":""),style:{gridColumn:"1/2",gridRow:"1/2"},onClick:function(t){e.handleFeed("your playlists")}},"Your Playlists"),n.a.createElement("div",{className:"button option view-link ".concat("top tracks"===a?"active":""),style:{gridColumn:"1/2",gridRow:"2/3"},onClick:function(t){e.handleFeed("top tracks")}},"Your Top Tracks"),n.a.createElement("div",{className:"button option view-link ".concat("top artists"===a?"active":""),style:{gridColumn:"1/2",gridRow:"3/3"},onClick:function(t){e.handleFeed("top artists")}},"Your Top Artists"),n.a.createElement("div",{className:"button option view-link ".concat("saved tracks"===a?"active":""),style:{gridColumn:"2/3",gridRow:"1/2"},onClick:function(t){e.handleFeed("saved tracks")}},"Your Saved Tracks"),n.a.createElement("div",{className:"button option view-link ".concat("saved albums"===a?"active":""),style:{gridColumn:"2/3",gridRow:"2/3"},onClick:function(t){e.handleFeed("saved albums")}},"Your Saved Albums"),n.a.createElement("div",{className:"button option view-link ".concat("followed artists"===a?"active":""),style:{gridColumn:"2/3",gridRow:"3/3"},onClick:function(t){e.handleFeed("followed artists")}},"Your Followed Artists"))),n.a.createElement("div",{style:{gridColumn:"2/3"}},n.a.createElement("div",{className:"launchPad-subgrid"},n.a.createElement("div",{className:"button option view-link ".concat("discover weekly"===a?"active":"").concat(i?"":" disabled-launch-option"),style:{gridColumn:"1/2",gridRow:"1/2"},onClick:function(t){i?e.handleFeed("discover weekly"):e.handleFeed(null)},tooltip:"Follow your Discover Weekly playlist on Spotify to view it here","tooltip-position":"right"},"Discover Weekly"),n.a.createElement("div",{className:"button option view-link ".concat("release radar"===a?"active":"").concat(r?"":" disabled-launch-option"),style:{gridColumn:"1/2",gridRow:"2/3"},onClick:function(t){r?e.handleFeed("release radar"):e.handleFeed(null)},tooltip:"Follow your Release Radar playlist on Spotify to view it here","tooltip-position":"right"},"Release Radar"),n.a.createElement("div",{className:"button option view-link ".concat("charts"===a?"active":""),style:{gridColumn:"1/2",gridRow:"3/4"},onClick:function(t){e.handleFeed("charts")}},"Charts"),n.a.createElement("div",{className:"button option view-link "+("spotifyPlaylists"===a?"active":""),style:{gridColumn:"2/3",gridRow:"1/2"},onClick:function(t){e.handleFeed("spotifyPlaylists")}},"Spotify Playlists"),n.a.createElement("div",{className:"button option view-link ".concat("genres"===a?"active":""),style:{gridColumn:"2/3",gridRow:"2/3"},onClick:function(t){e.handleFeed("genres")}},"Genres"),n.a.createElement("div",{className:"button option view-link "+("newReleases"===a?"active":""),style:{gridColumn:"2/3",gridRow:"3/4"},onClick:function(t){e.handleFeed("newReleases")}},"New Releases"))),n.a.createElement("div",{style:{gridColumn:"3/4"}},n.a.createElement("div",{className:"search"===a?"active":""},n.a.createElement(U,{API:s,addToFeed:l,updateRoot:o,currentRootCategory:a})),n.a.createElement("div",{className:"button option view-link launchPad-random ".concat("random artist"===a?"active":""),onClick:function(t){e.handleFeed("random artist")}},"Random Artist"),n.a.createElement("div",{className:"button option view-link launchPad-random ".concat("random genre"===a?"active":""),onClick:function(t){e.handleFeed("random genre")}},"Random Genre"))))}}]),t}(i.Component),W=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.firstOfMultipleCards,a=e.lastOfMultipleCards,i=e.firstInFeed,n=e.scrolledDown;if((t||!a)&&!i){var r=s.a.findDOMNode(this),o=Object(h.getPosition)(r);window.scrollTo({top:o.y,behavior:"smooth"}),n()}}},{key:"render",value:function(){var e=this.props,t=e.type,a=e.firstOfMultipleCards,i=e.children,r="card card-".concat(t.replace(" ","-")," ").concat(a?"firstOfMultipleCards":"");return n.a.createElement("div",{className:r},n.a.createElement("div",{className:"cardBody"},i))}}]),t}(i.Component),q=a(9),B=a(40),G=a.n(B),Y=a(41),J=a.n(Y),$=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={},a.magnified=!1,a.hasMagnified=!1,a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.size,a=e.thumbnailSize;this.setState({size:t||"md",image:this.getRightSizedImage(a)})}},{key:"getRightSizedImage",value:function(e){var t=this.props.images;if(Array.isArray(t)&&t.length>0){var a=t.sort(function(e,t){return e.width-t.width});return a.find(function(t){return t.width>=e&&t.height>=e})||a.slice(-1)[0]}return{url:t,width:null,height:null}}},{key:"render",value:function(){var e,t=this.props,a=t.type,i=t.thumbnailSize,r=t.label,s=t.secondaryLabel,o=t.showPlayerButton,l=t.playing,c=t.search,d=t.selected,u=t.previewUrl,m=t.additionalClasses,p=t.audio,h=t.id,v=t.nowPlaying,f=t.images,y=t.captionData,g=t.handleClick,k=t.hoverDeactivated,w=t.preventPreview,b=this.state,E=b.image,P=b.size,S="artist"===a?"itemImgCircle":"";e=E&&i?{backgroundImage:"url(".concat(E.url,")"),width:"".concat(i,"px"),height:"".concat(i,"px")}:E?{backgroundImage:"url(".concat(E.url,")")}:{};var O=r?n.a.createElement("div",null,n.a.createElement("div",{className:"itemLabel"},r),s?n.a.createElement("div",{className:"itemLabelSecondary"},s):""):"",T=o&&!window.playerError?n.a.createElement("img",{className:"playButtonOverlay",src:l?J.a:G.a,alt:"play"}):"",A=[];return A.push(c?"playable-search":"playable"),A.push("artist"===a?"playable-artist":""),d&&A.push("selected"),u&&""!==u||A.push("previewless"),m&&A.push(m),n.a.createElement("div",{className:A.join(" "),onMouseEnter:function(e){u&&!w&&p("start preview",h,u),o||v(!0,f,y,a)},onMouseOver:function(e){u&&!w&&p("start preview from click",h,u),o||v(!0,f,y,a)},onMouseLeave:function(e){k||(v(!1),u&&p("stop preview",h,u))},onClick:function(e){g&&g(e)}},T,n.a.createElement("div",{className:["itemImg","itemImg-".concat(P),S,c?"itemImg-search":""].join(" "),ref:"itemImg",style:e}),O)}}]),t}(i.Component),K=a(42),V=a.n(K),X=a(43),Z=a.n(X),ee=a(44),te=a.n(ee),ae=a(45),ie=a.n(ae),ne=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=[],a={};this.props.options&&Array.isArray(this.props.options)?this.props.options.forEach(function(i,r){i.disabled&&t.push(n.a.createElement("option",{key:"".concat(e.props.instance,"-").concat(i.id,"-").concat(r,"-a"),value:i.id,disabled:!!i.disabled})),t.push(n.a.createElement("option",{key:"".concat(e.props.instance,"-").concat(i.id,"-").concat(r),value:i.id,disabled:!!i.disabled},i.name)),"saved albums"!==e.props.type&&"new releases"!==e.props.type||(a[i.id]=i.album_ids)}):t.push(n.a.createElement("option",{key:"loading"},"Loading",n.a.createElement("span",null,"."),n.a.createElement("span",null,"."),n.a.createElement("span",null,".")));var i=this.props.value?this.props.value:"",r=this.props.label?n.a.createElement("h4",null,this.props.label):"",s=this.props.width?{maxWidth:"".concat(this.props.width,"px")}:{};return n.a.createElement("div",{className:"dropdown"},r,n.a.createElement("select",{style:s,value:i,onChange:function(t){e.props.handleChange(t.target.value,e.props.type,e.props.instance,"saved albums"===e.props.type||"new releases"===e.props.type?a[t.target.value]:null)}},t))}}]),t}(n.a.Component);function re(e,t,a,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return n.a.createElement("div",{onClick:a,className:"icon",style:{backgroundImage:"url(".concat(e,")")}},i,n.a.createElement("span",{className:"icon-label ".concat(r?"icon-label-persist":"")},t))}var se=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).addToPlaylist=a.addToPlaylist.bind(Object(m.a)(Object(m.a)(a))),a.state={playlistIconLabel:"Add to playlist"},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"addToPlaylist",value:function(e){var t=this,a=this.props,i=a.items,n=a.incrementStat,r=a.API,s=a.updateOwnPlaylists,o=i.map(function(e){return e.uri});if("new"===e){var l=window.prompt("Name for your playlist:","Discovered Quickly");r.modifyPlaylist("create playlist",null,{name:l,tracks:o}).then(function(){t.setState({playlistIconLabel:"Added!"}),n("numTracksAddedToPlaylists",i.length),s(!0),setTimeout(function(){t.setState({playlistIconLabel:"Add to playlist"})},3e3)},function(e){console.log(e),alert("Error adding to playlist! You may need to refresh the page and try again: it's okay, your queue will still be here.")})}else e.length>5&&r.modifyPlaylist("add to playlist",e,{tracks:o}).then(function(){t.setState({playlistIconLabel:"Added!"}),n("numTracksAddedToPlaylists",i.length),s(!0),setTimeout(function(){t.setState({playlistIconLabel:"Add to playlist"})},3e3)},function(e){console.log(e),alert("Error creating new playlist! You may need to refresh the page and try again: it's okay, your queue will still be here.")})}},{key:"render",value:function(){var e,t=this.props,a=t.type,i=t.id,r=t.following,s=t.handleFollow,o=t.followLabel,l=t.disableOpenOnSpotify,c=t.ownPlaylists,d=t.items,u=this.state.playlistIconLabel,m=[];c&&(m.push({id:"-",name:"Choose where to add..."}),m.push({id:"new",name:"<New Playlist>"}),m.push({id:"-",name:""}),c.filter(function(e){return e.canModify}).forEach(function(e){m.push({id:e.id,name:e.name})})),e=s?r?re(ie.a,o,null):re(Z.a,o,s):"";var p="track"===a&&d?n.a.createElement(ne,{instance:"actionsPanelAddToPlaylist",options:m,handleChange:this.addToPlaylist,value:""}):"",h="track"===a?re(te.a,u,null,p,"Added!"===u):"",v=l?"":re(V.a,"Open in Spotify",function(){!function(e,t){window.gtag("event","opened in spotify",{event_category:"navigation",event_label:e}),"true"===localStorage.getItem("openLinksInBrowser")?window.open("https://open.spotify.com/".concat(e,"/").concat(t)):window.location.href="spotify:".concat(e,":").concat(t)}(a,i)});return n.a.createElement("div",{className:"actions-panel"},e,h,v)}}]),t}(n.a.Component),oe=a(15),le=a.n(oe),ce=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={selected:null},a.componentDidMount=a.componentDidMount.bind(Object(m.a)(Object(m.a)(a))),a.handleSave=a.handleSave.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.API.getEntity("track",e.props.id).then(function(t){e.setState({track:t})})}},{key:"handleSave",value:function(){var e=this,t=this.props,a=t.API,i=t.incrementStat,n=t.id;a.saveOrFollowEntity("track",[e.props.id]).then(function(t){e.setState(function(e){return{track:Object(q.a)({},e.track,{userSavedTrack:t})}}),a.invalidateCache("album",n),i("numSavedTracks",1)})}},{key:"updateSelected",value:function(e,t){this.setState({selected:{context:e,id:t}})}},{key:"render",value:function(){var e=this,t=this.state,a=t.track,i=t.selected,r=this.props,s=r.API,o=r.addToFeed,l=r.id,c=r.addToQueue,d=r.activateDeactivateHoverAudio,u=r.audio,m=r.hoverDeactivated,p=r.nowPlaying,h=r.updateOwnPlaylists,f=r.ownPlaylists,y=r.incrementStat;if(!a)return n.a.createElement("div",{className:"loading"},"Loading track...");var g=n.a.createElement(se,{API:s,type:"track",id:l,following:a.userSavedTrack,handleFollow:this.handleSave,followLabel:a.userSavedTrack?"Track saved":"Save this track",incrementStat:y,ownPlaylists:f,items:[a],updateOwnPlaylists:h}),k=a.artists?a.artists.slice(0,window.settings.listLimit).map(function(t){return n.a.createElement($,{key:t.id,type:"artist",size:"sm",id:t.id,selected:i&&"artist images"===i.context&&i.id===t.id,images:t.images.length?t.images:t.topTracks.length?t.topTracks[0].album.images:[],handleClick:function(){e.updateSelected("artist images",t.id),o(l,{type:"artist",id:t.id}),t.topTracks.length&&c(t.topTracks[0].id),d(!0)},audio:u,hoverDeactivated:m,nowPlaying:p,previewUrl:t.topTracks.length?t.topTracks[0].preview_url:null,captionData:{track_name:t.topTracks.length?t.topTracks[0].name:null,track_artist_name:t.topTracks.length?t.topTracks[0].artists.map(function(e){return e.name}).reduce(function(e,a,i){return[e,i===t.topTracks[0].artists.length-1?" & ":", ",a].join("")}):null,artist_name:t.name}})}):"",w=i&&"album name"===i.context?"selected":"",b=n.a.createElement("span",{className:"view-link ".concat(w),role:"link",tabIndex:0,onClick:function(){e.updateSelected("album name",null),o(l,{type:"album",id:a.album.id})},onKeyDown:function(){e.updateSelected("album name",null),o(l,{type:"album",id:a.album.id})}},v.a.shortenString(a.album.name,40)),E=a.artists.map(function(t){var a=i&&"artist name"===i.context&&i.id===t.id?"selected":"";return n.a.createElement("span",{key:"artist-name-".concat(t.id),className:"view-link ".concat(a),role:"link",tabIndex:0,onClick:function(){e.updateSelected("artist name",t.id),o(l,{type:"artist",id:t.id})},onKeyDown:function(){e.updateSelected("artist name",t.id),o(l,{type:"artist",id:t.id})}},t.name)}).reduce(function(e,t,i){return[e,i===a.artists.length-1?" & ":", ",t]}),P=i&&"recs"===i.context?"selected":"",S=n.a.createElement("span",{className:"view-link ".concat(P),role:"link",tabIndex:0,onClick:function(){e.updateSelected("recs",null),o(l,{type:"magic",id:"magic-".concat(a.id),generatedFrom:"".concat(a.name," by ").concat(a.artists[0].name),seed:{tracks:[a.id]}})},onKeyDown:function(){e.updateSelected("recs",null),o(l,{type:"magic",id:"magic-".concat(a.id),generatedFrom:"".concat(a.name," by ").concat(a.artists[0].name),seed:{tracks:[a.id]}})}},n.a.createElement("img",{src:le.a,className:"icon-magic",alt:"Magic wand icon"}),"Recommended songs based on this");return n.a.createElement("div",{className:"trackEntity"},g,n.a.createElement("div",{className:"flex-container"},n.a.createElement("div",{style:{marginRight:"16px"}},n.a.createElement($,{key:a.id,size:"md",type:"track",id:a.id,images:a.album.images,handleClick:function(){c(a.id),d(!0)},audio:u,hoverDeactivated:m,nowPlaying:p,previewUrl:a.preview_url,captionData:{track_name:a.name,track_artist_name:a.artists.map(function(e){return e.name}).reduce(function(e,t,i){return[e,i===a.artists.length-1?" & ":", ",t].join("")})}})),n.a.createElement("div",{style:{flexGrow:5}},n.a.createElement("h2",null,a.name),n.a.createElement("div",{className:"info"},n.a.createElement("div",null,"From the ".concat(a.album.album_type," "),b," (".concat(a.album.release_date.slice(0,4),")")),n.a.createElement("div",null,"By ",E),n.a.createElement("br",null),n.a.createElement("div",{className:"info"},S))),n.a.createElement("div",{style:{margin:"8px 16px 0"}},k)))}}]),t}(i.Component),de=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={selected:null},a.handleSave=a.handleSave.bind(Object(m.a)(Object(m.a)(a))),a.updateSelected=a.updateSelected.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;e.props.API.getEntity("artist",e.props.id).then(function(t){e.setState({artist:t,albums:t.albums.filter(function(t){return t.artists.find(function(t){return t.id===e.props.id})&&"album"===t.album_type}),singlesEtc:t.albums.filter(function(t){return t.artists.find(function(t){return t.id===e.props.id})&&"album"!==t.album_type}),appearsOn:t.albums.filter(function(t){return!t.artists.find(function(t){return t.id===e.props.id})})}),e.props.API.getEntity("genrePlaylists").then(function(a){e.setState({genres:a.items.filter(function(e){return t.genres.indexOf(e.name)>-1})})})})}},{key:"getId",value:function(){return this.state.id}},{key:"updateSelected",value:function(e,t){this.setState({selected:{context:e,id:t}})}},{key:"handleSave",value:function(){var e=this;e.props.API.saveOrFollowEntity("artist",e.props.id).then(function(t){e.setState(function(e){return{artist:Object(q.a)({},e.artist,{userFollowsArtist:t})}}),e.props.API.invalidateCache("artist",e.props.id),e.props.incrementStat("numFollowedArtists",1)})}},{key:"render",value:function(){var e,t=this,a=this;if(!this.state.artist)return n.a.createElement("div",{className:"loading"},"Loading artist...");e=this.state.genres&&this.state.genres.length>0?this.state.genres.map(function(e){var a=t.state.selected&&"genres"===t.state.selected.context&&t.state.selected.id===e.id?"selected":"";return n.a.createElement("span",{className:"view-link ".concat(a),onClick:function(){t.updateSelected("genres",e.id),t.props.addToFeed(t.props.id,{type:"playlist",id:e.id})},key:e.name},e.name)}).reduce(function(e,t){return[e,", ",t]}):this.state.genres&&0===this.state.genres.length?"":"Loading genres...";var i=n.a.createElement(se,{type:"artist",id:this.props.id,following:this.state.artist.userFollowsArtist,handleFollow:this.handleSave,followLabel:this.state.artist.userFollowsArtist?"You follow this artist":"Follow this artist"}),r=this.state.artist.topTracks?this.state.artist.topTracks.slice(0,window.settings.listLimit).map(function(e){return n.a.createElement($,{key:e.id,type:"track",id:e.id,selected:t.state.selected&&"top tracks"===t.state.selected.context&&t.state.selected.id===e.id,size:"sm",images:e.album.images,handleClick:function(a){t.updateSelected("top tracks",e.id),t.props.addToFeed(t.props.id,{type:"track",id:e.id}),t.props.addToQueue(e.id),t.props.activateDeactivateHoverAudio(!0)},audio:t.props.audio,hoverDeactivated:t.props.hoverDeactivated,nowPlaying:t.props.nowPlaying,previewUrl:e.preview_url,captionData:{track_name:e.name,track_artist_name:e.artists.map(function(e){return e.name}).reduce(function(t,a,i){return[t,i===e.artists.length-1?" & ":", ",a].join("")})}})}):"",s=[{title:"Albums",key:"albums",size:54},{title:"Singles & Compilations",key:"singlesEtc",size:28},{title:"Appears On",key:"appearsOn",size:28}].map(function(e){if(0===a.state[e.key].length)return"";var i=e.size?e.size:Object(h.sizeThumbnails)(a.state[e.key].length,480,200);return[n.a.createElement("h4",{key:"title"},e.title)].concat(a.state[e.key].map(function(a){return n.a.createElement($,{key:a.id,type:"album",id:a.id,selected:t.state.selected&&t.state.selected.context===e.key&&t.state.selected.id===a.id,size:"sm",images:a.images,handleClick:function(){t.updateSelected(e.key,a.id),t.props.addToFeed(t.props.id,{type:"album",id:a.id}),t.props.addToQueue(a.tracks.items[0].id),t.props.activateDeactivateHoverAudio(!0)},audio:t.props.audio,hoverDeactivated:t.props.hoverDeactivated,nowPlaying:t.props.nowPlaying,previewUrl:a.tracks.items[0].preview_url,thumbnailSize:i,captionData:{track_name:a.tracks.items[0].name,track_artist_name:a.tracks.items[0].artists.map(function(e){return e.name}).reduce(function(e,t,i){return[e,i===a.tracks.items[0].artists.length-1?" & ":", ",t].join("")}),album_name:a.name,album_artist_name:a.artists.map(function(e){return e.name}).reduce(function(e,t,i){return[e,i===a.artists.length-1?" & ":", ",t].join("")})}})}))}),o=[{title:"Albums",key:"albums",size:54},{title:"Singles & Compilations",key:"singlesEtc",size:28}].map(function(e){return a.state[e.key]}).reduce(function(e,t){return e.concat(t)},[]),l=o.length,c=Math.min.apply(null,o.map(function(e){return+e.release_date.slice(0,4)})),d=Math.max.apply(null,o.map(function(e){return+e.release_date.slice(0,4)})),u=l>0?l>1?"".concat(l," releases between ").concat(c," - ").concat(2020===d?"present":d):"1 release in ".concat(c):"",m=this.state.artist.relatedArtists.length>0?[n.a.createElement("h4",{key:"related-artists"},"Related Artists")].concat(this.state.artist.relatedArtists.slice(0,window.settings.listLimit).map(function(e){return n.a.createElement($,{key:e.id,type:"artist",id:e.id,selected:t.state.selected&&"related artists"===t.state.selected.context&&t.state.selected.id===e.id,size:"sm",images:e.images.length?e.images:e.topTracks.length?e.topTracks[0].album.images:[],handleClick:function(a){t.updateSelected("related artists",e.id),t.props.addToFeed(t.props.id,{type:"artist",id:e.id}),e.topTracks.length&&t.props.addToQueue(e.topTracks[0].id),t.props.activateDeactivateHoverAudio(!0)},audio:t.props.audio,hoverDeactivated:t.props.hoverDeactivated,nowPlaying:t.props.nowPlaying,previewUrl:e.topTracks.length?e.topTracks[0].preview_url:null,captionData:{track_name:e.topTracks.length?e.topTracks[0].name:null,track_artist_name:e.topTracks.length?e.topTracks[0].artists.map(function(e){return e.name}).reduce(function(t,a,i){return[t,i===e.topTracks[0].artists.length-1?" & ":", ",a].join("")}):null,artist_name:e.name}})})):"",p=this.state.artist.this_is&&(this.props.showUnplayable||this.state.artist.this_is.preview_track.track.preview_url)?n.a.createElement("div",{className:"artistThisIs"},n.a.createElement($,{type:"playlist",size:"md",id:this.state.artist.name,selected:this.state.selected&&"this is"===this.state.selected.context&&this.state.selected.id===this.state.artist.this_is.playlist_id,images:this.state.artist.this_is.images,handleClick:function(e){t.updateSelected("this is",t.state.artist.this_is.playlist_id),t.props.addToFeed(t.props.id,{type:"playlist",id:t.state.artist.this_is.playlist_id}),t.props.addToQueue(t.state.artist.this_is.preview_track.track.id),t.props.activateDeactivateHoverAudio(!0)},audio:this.props.audio,hoverDeactivated:this.props.hoverDeactivated,nowPlaying:this.props.nowPlaying,previewUrl:this.state.artist.this_is.preview_track.track.preview_url,captionData:{track_name:this.state.artist.this_is.preview_track.track.name,track_artist_name:this.state.artist.this_is.preview_track.track.artists.map(function(e){return e.name}).reduce(function(e,a,i){return[e,i===t.state.artist.this_is.preview_track.track.artists.length-1?" & ":", ",a].join("")}),playlist_name:"This Is ".concat(this.state.artist.name)}})):"",v=this.state.selected&&"recs"===this.state.selected.context?"selected":"",f=n.a.createElement("span",{className:"view-link ".concat(v),onClick:function(){t.updateSelected("recs",null),t.props.addToFeed(t.props.id,{type:"magic",id:"magic-".concat(t.props.id),generatedFrom:t.state.artist.name,seed:{artists:[t.props.id]}})}},n.a.createElement("img",{src:le.a,className:"icon-magic",alt:"Magic wand icon"}),"Recommended songs based on ",Object(h.shortenString)(this.state.artist.name,40));return n.a.createElement("div",{className:"gridContainer"},i,n.a.createElement("div",{style:{gridColumn:"1/3"}},n.a.createElement($,{type:"artist",size:"lg",id:this.state.artist.name,selected:this.state.selected&&"main image"===this.state.selected.context&&this.state.selected.id===this.state.artist.topTracks[0].id,images:this.state.artist.images.length?this.state.artist.images:this.state.artist.topTracks.length?this.state.artist.topTracks[0].album.images:[],handleClick:function(e){t.updateSelected("main image",t.state.artist.topTracks[0].id),t.props.addToFeed(t.props.id,{type:"track",id:t.state.artist.topTracks[0].id}),t.props.addToQueue(t.state.artist.topTracks[0].id),t.props.activateDeactivateHoverAudio(!0)},audio:this.props.audio,hoverDeactivated:this.props.hoverDeactivated,nowPlaying:this.props.nowPlaying,previewUrl:this.state.artist.topTracks.length?this.state.artist.topTracks[0].preview_url:null,captionData:{track_name:this.state.artist.topTracks.length?this.state.artist.topTracks[0].name:null,track_artist_name:this.state.artist.topTracks.length?this.state.artist.topTracks[0].artists.map(function(e){return e.name}).reduce(function(e,a,i){return[e,i===t.state.artist.topTracks[0].artists.length-1?" & ":", ",a].join("")}):null,artist_name:this.state.artist.name}})),n.a.createElement("div",{style:{gridColumn:"3/8"}},n.a.createElement("h1",null,this.state.artist.name),n.a.createElement("div",{className:"info"},p,n.a.createElement("div",null,e),n.a.createElement("br",null),n.a.createElement("div",null,u),n.a.createElement("div",null,n.a.createElement("span",{className:"space-right-sm"},Object(h.addCommas)(this.state.artist.followers.total)," ","followers")),n.a.createElement("div",null,f))),n.a.createElement("div",{style:{gridColumn:"8/10",gridRow:"1/3",margin:"12px 0 0 18px"}},m),n.a.createElement("div",{style:{gridColumn:"1/8"}},n.a.createElement("h4",null,"Top Tracks"),r,s))}}]),t}(i.Component),ue=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={selected:null},a.handleSave=a.handleSave.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.API,i=t.id;a.getEntity("album",i).then(function(t){e.setState({album:t})})}},{key:"handleSave",value:function(){var e=this;e.props.API.saveOrFollowEntity("album",e.props.id).then(function(t){e.setState(function(e){return{album:Object(q.a)({},e.album,{userSavedAlbum:t})}}),e.props.API.invalidateCache("album",e.props.id),e.props.incrementStat("numSavedAlbums",1)})}},{key:"updateSelected",value:function(e,t){this.setState({selected:{context:e,id:t}})}},{key:"render",value:function(){var e=this;if(!this.state.album)return n.a.createElement("div",{className:"loading"},"Loading album...");var t=n.a.createElement(se,{type:"album",id:this.props.id,following:this.state.album.userSavedAlbum,handleFollow:this.handleSave,followLabel:this.state.album.userSavedAlbum?"You saved this album":"Save this album"}),a=this.state.album?this.state.album.tracks.items.map(function(t){return n.a.createElement($,{key:t.id,type:"track",id:t.id,selected:e.state.selected&&"track list"===e.state.selected.context&&e.state.selected.id===t.id,size:"xs",label:Object(h.shortenString)(t.name,35),images:e.state.album.images,handleClick:function(a){e.updateSelected("track list",t.id),e.props.addToFeed(e.props.id,{type:"track",id:t.id}),e.props.addToQueue(t.id),e.props.activateDeactivateHoverAudio(!0)},audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,previewUrl:t.preview_url,captionData:{track_name:t.name,track_artist_name:t.artists.map(function(e){return e.name}).reduce(function(e,a,i){return[e,i===t.artists.length-1?" & ":", ",a].join("")})}})}):"",i=this.state.album.artists?this.state.album.artists.slice(0,window.settings.listLimit).map(function(t){return n.a.createElement($,{key:t.id,type:"artist",id:t.id,selected:e.state.selected&&"artist images"===e.state.selected.context&&e.state.selected.id===t.id,images:t.images,size:"sm",handleClick:function(a){e.updateSelected("artist images",t.id),e.props.addToFeed(e.props.id,{type:"artist",id:t.id}),t.topTracks.length&&e.props.addToQueue(t.topTracks[0].id),e.props.activateDeactivateHoverAudio(!0)},audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,previewUrl:t.topTracks.length?t.topTracks[0].preview_url:null,captionData:{track_name:t.topTracks.length?t.topTracks[0].name:null,track_artist_name:t.topTracks.length?t.topTracks[0].artists.map(function(e){return e.name}).reduce(function(e,a,i){return[e,i===t.topTracks[0].artists.length-1?" & ":", ",a].join("")}):null,artist_name:t.name}})}):"";return n.a.createElement("div",{className:"gridContainer"},t,n.a.createElement("div",{style:{gridColumnStart:1,gridColumnEnd:3}},n.a.createElement($,{type:"album",id:this.state.album.id,size:"lg",images:this.state.album.images,handleClick:function(t){e.props.addToQueue(e.state.album.tracks.items[0].id),e.props.activateDeactivateHoverAudio(!0)},audio:this.props.audio,hoverDeactivated:this.props.hoverDeactivated,nowPlaying:this.props.nowPlaying,previewUrl:this.state.album.tracks.items[0].preview_url,captionData:{track_name:this.state.album.tracks.items[0].name,track_artist_name:this.state.album.tracks.items[0].artists.map(function(e){return e.name}).reduce(function(t,a,i){return[t,i===e.state.album.tracks.items[0].artists.length-1?" & ":", ",a].join("")}),album_name:this.state.album.name,album_artist_name:this.state.album.artists.map(function(e){return e.name}).reduce(function(t,a,i){return[t,i===e.state.album.artists.length-1?" & ":", ",a].join("")})}})),n.a.createElement("div",{style:{gridColumnStart:3,gridColumnEnd:6}},n.a.createElement("h1",null,this.state.album.name),n.a.createElement("div",{className:"info"},"Released ".concat(Object(h.formatReleaseDate)(this.state.album))),n.a.createElement("div",{className:"info"},n.a.createElement("div",null,"".concat(this.state.album.type," by "),n.a.createElement("span",{className:"view-link",onClick:function(t){return e.props.addToFeed(e.props.id,{type:"artist",id:e.state.album.artists[0].id})}},this.state.album.artists[0].name))),n.a.createElement("div",{className:"artistList"},i)),n.a.createElement("div",{style:{gridColumnStart:6,gridColumnEnd:10}},n.a.createElement("h4",null,"Tracks"),n.a.createElement("div",{className:"trackList"},n.a.createElement("div",{className:"fade"}),n.a.createElement("div",{className:"innerScroll"},a))))}}]),t}(i.Component),me=a(53);var pe=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.items?Object(h.sizeThumbnails)(this.props.items.length,this.props.width,this.props.height):0,a=this.props.items?this.props.items.map(function(a,i){return a?n.a.createElement($,{key:"".concat(i,"_").concat(a.id),type:e.props.gridType,id:a.id,selected:e.props.selected&&e.props.selected===a.id,images:a.images,handleClick:function(t){e.props.handleClick(a)},audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,previewUrl:a.preview_url,thumbnailSize:t,captionData:(r=e.props.gridType,s=a,"track"===r?{track_name:s.track.name,track_artist_name:s.track.artists.map(function(e){return e.name}).reduce(function(e,t,a){return[e,a===s.track.artists.length-1?" & ":", ",t].join("")})}:"artist"===r?{track_name:s.artist.topTracks.length?s.artist.topTracks[0].name:null,track_artist_name:s.artist.topTracks.length?s.artist.topTracks[0].artists.map(function(e){return e.name}).reduce(function(e,t,a){return[e,a===s.artist.topTracks[0].artists.length-1?" & ":", ",t].join("")}):null,artist_name:s.artist.name}:"album"===r?{track_name:s.album.tracks.items[0].name,track_artist_name:s.album.tracks.items[0].artists.map(function(e){return e.name}).reduce(function(e,t,a){return[e,a===s.album.tracks.items[0].artists.length-1?" & ":", ",t].join("")}),album_name:s.album.name,album_artist_name:s.album.artists.map(function(e){return e.name}).reduce(function(e,t,a){return[e,a===s.album.artists.length-1?" & ":", ",t].join("")})}:null)}):"";var r,s}):"";return n.a.createElement("div",{className:"itemGrid"},a)}}]),t}(i.Component),he=a(46),ve=a.n(he),fe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.handleClick,a=["refreshButton"];return e.refreshing&&a.push("refreshing"),n.a.createElement("span",{className:a.join(" "),onClick:t,tooltip:"Not seeing what you expect? Try clicking here to refresh.","tooltip-position":"right"},n.a.createElement("img",{src:ve.a,alt:"Refresh"}))}}]),t}(n.a.Component);var ye=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={selected:null,refreshing:!1},a.fetchData=a.fetchData.bind(Object(m.a)(Object(m.a)(a))),a.handleSaveOrFollow=a.handleSaveOrFollow.bind(Object(m.a)(Object(m.a)(a))),a.updateSelected=a.updateSelected.bind(Object(m.a)(Object(m.a)(a))),a.handleRefresh=a.handleRefresh.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetchData();var e=[{id:"",name:"Sort by ".concat(this.props.savedTracks?"save date":this.props.topTracks?"song affinity":"playlist order")},{id:"artist",name:"Sort by artist"},{id:"album",name:"Sort by album"},{id:"popularity",name:"Sort by popularity (least to most)"},{id:"releaseDate",name:"Sort by release date"},{id:"tempo",name:"Sort slowest to fastest"},{id:"valence",name:"Sort happiest to saddest"},{id:"danceability",name:"Sort by most to least danceable"},{id:"duration",name:"Sort by song length (short to long)"},{id:"acoustic",name:"Sort acoustic to electric"}];this.setState({sortOptions:e}),this.setState({currentSortOption:""})}},{key:"componentDidUpdate",value:function(){this.props.lastInFeed&&window.scrollTo({top:document.body.clientHeight,behavior:"smooth"})}},{key:"fetchData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,a=this.props.API;t.setState({refreshing:!0}),t.props.seed?(e&&a.invalidateCache("recommendations",t.props.id),t.props.API.getEntity("recommendations",t.props.id,t.props.seed).then(function(e){e.name="Recommended songs based on ".concat(t.props.generatedFrom),t.setState({refreshing:!1,playlist:e,magic:!0})})):t.props.savedTracks?(e&&a.invalidateCache("saved tracks"),t.props.API.getEntity("saved tracks").then(function(e){e.name="Your Saved Tracks",t.setState({refreshing:!1,playlist:e,magic:!1})})):t.props.topTracks?(e&&a.invalidateCache("top tracks"),t.props.API.getEntity("top tracks").then(function(e){Object.keys(e).forEach(function(t){e[t].name="Your Top Tracks"}),t.setState({refreshing:!1,playlist:e[3!==Object.keys(e).length?Object.keys(e)[0]:"short_term"],timeRange:3!==Object.keys(e).length?Object.keys(e)[0]:"short_term",topTrackLookup:e,magic:!0,timeRangesPresent:Object.keys(e)})})):(e&&a.invalidateCache("playlist",t.props.id),t.props.API.getEntity("playlist",t.props.id).then(function(e){t.setState({refreshing:!1,playlist:e})}))}},{key:"updateSelected",value:function(e,t){this.setState({selected:{context:t,id:e}})}},{key:"handleSort",value:function(e){this.setState({currentSortOption:e})}},{key:"handleTimeRangeToggle",value:function(e){this.setState({playlist:this.state.topTrackLookup[e],timeRange:e})}},{key:"handleSaveOrFollow",value:function(){var e,t,a,i=this;i.state.magic?(e="magic",t=i.state.playlist.name,a=i.state.playlist.items):(e="playlist",t=i.props.id),i.props.API.saveOrFollowEntity(e,t,a).then(function(e){!0===e&&(i.setState(function(t){return{playlist:Object(q.a)({},t.playlist,{userFollowsPlaylist:e})}}),i.props.incrementStat("numFollowedPlaylists",1),i.props.updateOwnPlaylists(!0))})}},{key:"handleRefresh",value:function(){this.fetchData(!0)}},{key:"sortPlaylist",value:function(e,t){var a=this;switch(t){case"releaseDate":return e.sort(function(e,t){return e.track.album.release_date&&t.track.album.release_date&&Object(h.epochTimeReleaseDate)(e.track.album)<Object(h.epochTimeReleaseDate)(t.track.album)?-1:1});case"artist":return e.sort(function(e,t){return e.track.artists[0]&&t.track.artists[0]&&e.track.artists[0].name.toLowerCase()<t.track.artists[0].name.toLowerCase()?-1:1});case"album":return e.sort(function(e,t){return e.track.album.name&&t.track.album.name&&e.track.album.name.toLowerCase()<t.track.album.name.toLowerCase()?-1:1});case"popularity":return e.sort(function(e,t){return e.track.popularity<t.track.popularity?-1:e.track.popularity>t.track.popularity?1:e.track.name.toLowerCase()<t.track.name.toLowerCase()?-1:1});case"tempo":return e.sort(function(e,t){return e.track.audio_features&&t.track.audio_features?e.track.audio_features.tempo<t.track.audio_features.tempo?-1:e.track.audio_features.tempo>t.track.audio_features.tempo?1:e.track.name.toLowerCase()<t.track.name.toLowerCase()?-1:1:1});case"valence":return e.sort(function(e,t){return e.track.audio_features&&t.track.audio_features?e.track.audio_features.valence<t.track.audio_features.valence?1:e.track.audio_features.valence>t.track.audio_features.valence?-1:e.track.name.toLowerCase()<t.track.name.toLowerCase()?-1:1:1});case"danceability":return e.sort(function(e,t){return e.track.audio_features&&t.track.audio_features?e.track.audio_features.danceability<t.track.audio_features.danceability?1:e.track.audio_features.danceability>t.track.audio_features.danceability?-1:e.track.name.toLowerCase()<t.track.name.toLowerCase()?-1:1:1});case"acoustic":return e.sort(function(e,t){return e.track.audio_features&&t.track.audio_features?e.track.audio_features.acousticness<t.track.audio_features.acousticness?1:e.track.audio_features.acousticness>t.track.audio_features.acousticness?-1:e.track.name.toLowerCase()<t.track.name.toLowerCase()?-1:1:1});case"duration":return e.sort(function(e,t){return e.track.audio_features&&t.track.audio_features?e.track.audio_features.duration_ms<t.track.audio_features.duration_ms?-1:e.track.audio_features.duration_ms>t.track.audio_features.duration_ms?1:e.track.name.toLowerCase()<t.track.name.toLowerCase()?-1:1:1});default:return e.sort(function(e,t){var i;return e[i=a.props.topTracks?"affinity_rank":a.props.savedTracks?"save_order":"playlist_track_number"]<t[i]?-1:1})}}},{key:"render",value:function(){var e=this,t=this.state,a=t.playlist,i=t.selected,r=t.refreshing,s=t.timeRangesPresent,o=this.props,l=o.savedTracks,c=o.topTracks,d=o.audio,u=o.hoverDeactivated,m=o.nowPlaying,p=o.addToFeed,v=o.addToQueue,f=o.id,y=o.activateDeactivateHoverAudio;if(!a)return n.a.createElement("div",{className:"loading"},"Loading ",l||c?"tracks":"playlist",n.a.createElement("span",null,"."),n.a.createElement("span",null,"."),n.a.createElement("span",null,"."));var g=a.items&&0===a.items.length?n.a.createElement("div",{className:"loading"},this.state.magic?"Sorry, we were unable to generate recommendations based on ".concat(this.props.generatedFrom,". Try a different path."):l?"No saved tracks.":"There are no songs on this playlist."):"",k=a.main_img?n.a.createElement($,{type:"playlist",size:"sm",thumbnailSize:105,id:"".concat(a.name,"-lead-img"),images:a.main_img,audio:d,hoverDeactivated:u,nowPlaying:m,selected:i&&"playlist image"===i.context&&i.id===a.items[0].track.id,previewUrl:a.items.length&&a.items[0].track.preview_url?a.items[0].track.preview_url:null,handleClick:function(){e.updateSelected(a.items[0].track.id,"playlist image"),p(f,[{type:"track",id:a.items[0].track.id},{type:"artist",id:a.items[0].track.artists[0].id}]),v(a.items[0].track.id),y(!0)},additionalClasses:"playlist-main-image",captionData:{track_name:a.items[0].track.name,track_artist_name:a.items[0].track.artists.map(function(e){return e.name}).reduce(function(e,t,i){return[e,i===a.items[0].track.artists.length-1?" & ":", ",t].join("")}),playlist_name:a.name}}):"",w={short_term:"Last Month",medium_term:"Last 6 Months",long_term:"All Time"},b=c?n.a.createElement("div",null,s.map(function(t){return n.a.createElement("span",{key:"key-".concat(t),onClick:function(a){e.handleTimeRangeToggle(t)},className:"view-link time-toggle ".concat(e.state.timeRange===t?"time-toggle-selected":"")},w[t])})):"",E=this.state.playlist?this.sortPlaylist(this.state.playlist.items,this.state.currentSortOption).filter(function(t){return e.props.showUnplayable||t.track.preview_url}).map(function(e){return e?{id:e.track.id,images:e.track.album.images,preview_url:e.track.preview_url,artistId:e.track.artists[0].id,track:e.track}:""}):"",P=a.description&&a.description.length?n.a.createElement("div",null,function(e){var t=(new DOMParser).parseFromString(e,"text/html").body.childNodes;return Object(me.a)(t).map(function(e){if("A"===e.nodeName){var t=Object(h.getEntityFromLink)(e.href);if(t)return{entityType:t.entity,id:t.id,text:e.textContent}}return{entityType:!1,id:!1,text:e.textContent}})}(a.description).map(function(t,a){var r=i&&"playlist description"===i.context&&i.id===t.id?"selected":"";return t.entityType?n.a.createElement("span",{className:"view-link ".concat(r),key:"description-link-".concat(f,"-").concat(a),onClick:function(){e.updateSelected(t.id,"playlist description"),p(f,[{type:t.entityType,id:t.id}])}},t.text):t.text})):"",S=n.a.createElement(se,{type:"playlist",id:f,following:this.state.playlist.userFollowsPlaylist,handleFollow:this.handleSaveOrFollow,followLabel:this.state.playlist.userFollowsPlaylist?"You follow this":"Follow this playlist"});return n.a.createElement("div",{className:"playlistView"},S,n.a.createElement("div",{className:"header flex-container",style:{alignItems:"flex-end"}},k,n.a.createElement("div",{className:"titleSection",style:{flexGrow:5}},n.a.createElement("h1",{className:"playlist-name"},a.name,n.a.createElement(fe,{handleClick:this.handleRefresh,refreshing:r})),n.a.createElement("div",{className:"playlist-description"}," ",P," "),n.a.createElement("div",{className:"info"},this.props.topTracks?b:"")),n.a.createElement("div",{style:{margin:"0 0 5px 16px"},className:"selectLight"},n.a.createElement(ne,{instance:"sortOptions",options:this.state.sortOptions,value:this.state.currentSortOption,handleChange:this.handleSort.bind(this),width:160}))),n.a.createElement("div",{className:"body"},g,n.a.createElement(pe,{gridType:"track",audio:d,hoverDeactivated:u,nowPlaying:m,width:window.settings.feedGridSize[0],height:window.settings.feedGridSize[1],items:E,selected:this.state.selected&&"grid"===this.state.selected.context?this.state.selected.id:"",handleClick:function(t){e.updateSelected(t.id,"grid"),e.props.addToFeed(e.props.id,[{type:"track",id:t.id},{type:"artist",id:t.artistId}]),e.props.addToQueue(t.id),e.props.activateDeactivateHoverAudio(!0)}})))}}]),t}(i.Component),ge=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={selected:null},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getId",value:function(){return this.state.id}},{key:"componentDidMount",value:function(){var e=this;""===e.props.id?e.setState({helpMessage:!0,search:{}}):e.props.API.getEntity("search card",e.props.id).then(function(t){e.setState({search:t})})}},{key:"updateSelected",value:function(e,t){this.setState({selected:{context:e,id:t}})}},{key:"render",value:function(){var e=this;if(!this.state.search)return n.a.createElement("div",{className:"loading"},"Loading search results...");if(this.state.helpMessage)return n.a.createElement("div",{className:"loading"},"Search for something, or select a different starting point above");var t=this.state.search.tracks.items.length?this.state.search.tracks.items.slice(0,5).filter(function(t){return e.props.showUnplayable||t.preview_url}).map(function(t){return n.a.createElement($,{key:t.id,search:!0,type:"track",id:t.id,selected:e.state.selected&&"tracks"===e.state.selected.context&&e.state.selected.id===t.id,size:"xs",images:t.album.images,label:Object(h.shortenString)(t.name,35),secondaryLabel:Object(h.shortenString)(t.artists.map(function(e){return e.name}).reduce(function(e,a,i){return[e,i===t.artists.length-1?" & ":", ",a].join("")}),35),handleClick:function(a){e.updateSelected("tracks",t.id),e.props.addToFeed(e.props.id,[{type:"track",id:t.id},{type:"artist",id:t.artists[0].id}]),e.props.addToQueue(t.id),e.props.activateDeactivateHoverAudio(!0)},audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,previewUrl:t.preview_url,captionData:{track_name:t.name,track_artist_name:t.artists.map(function(e){return e.name}).reduce(function(e,a,i){return[e,i===t.artists.length-1?" & ":", ",a].join("")})}})}):n.a.createElement("div",{className:"info"},"No results"),a=this.state.search.albums.items.length?this.state.search.albums.items.slice(0,5).filter(function(t){return e.props.showUnplayable||t.tracks.items.length&&t.tracks.items[0].preview_url}).map(function(t){return n.a.createElement($,{key:t.id,search:!0,type:"album",id:t.id,selected:e.state.selected&&"albums"===e.state.selected.context&&e.state.selected.id===t.id,size:"xs",images:t.images,label:Object(h.shortenString)(t.name,35),secondaryLabel:Object(h.shortenString)(t.artists.map(function(e){return e.name}).reduce(function(e,a,i){return[e,i===t.artists.length-1?" & ":", ",a].join("")}),35),handleClick:function(a){e.updateSelected("albums",t.id),e.props.addToFeed(e.props.id,{type:"album",id:t.id}),e.props.addToQueue(t.tracks.items[0].id),e.props.activateDeactivateHoverAudio(!0)},audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,previewUrl:t.tracks.items[0].preview_url,captionData:{track_name:t.tracks.items[0].name,track_artist_name:t.tracks.items[0].artists.map(function(e){return e.name}).reduce(function(e,a,i){return[e,i===t.tracks.items[0].artists.length-1?" & ":", ",a].join("")}),album_name:t.name,album_artist_name:t.artists.map(function(e){return e.name}).reduce(function(e,a,i){return[e,i===t.artists.length-1?" & ":", ",a].join("")})},handleMouseOver:function(a){return e.props.audio("start preview",t.id,t.tracks.items[0].preview_url)},handleMouseOut:function(a){return e.props.audio("stop preview",t.id,t.tracks.items[0].preview_url)}})}):n.a.createElement("div",{className:"info"},"No results"),i=this.state.search.artists.items.length?this.state.search.artists.items.slice(0,5).filter(function(t){return e.props.showUnplayable||t.topTracks.length&&t.topTracks[0].preview_url}).map(function(t){return n.a.createElement($,{key:t.id,search:!0,type:"artist",id:t.id,selected:e.state.selected&&"artists"===e.state.selected.context&&e.state.selected.id===t.id,size:"xs",images:t.images.length?t.images:t.topTracks.length?t.topTracks[0].album.images:[],label:Object(h.shortenString)(t.name,35),handleClick:function(a){e.updateSelected("artists",t.id),e.props.addToFeed(e.props.id,{type:"artist",id:t.id}),t.topTracks.length&&e.props.addToQueue(t.topTracks[0].id),e.props.activateDeactivateHoverAudio(!0)},audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,previewUrl:t.topTracks.length?t.topTracks[0].preview_url:null,captionData:{track_name:t.topTracks.length?t.topTracks[0].name:null,track_artist_name:t.topTracks.length?t.topTracks[0].artists.map(function(e){return e.name}).reduce(function(e,a,i){return[e,i===t.topTracks[0].artists.length-1?" & ":", ",a].join("")}):null,artist_name:t.name}})}):n.a.createElement("div",{className:"info"},"No results"),r=this.state.search.playlists.items.length?this.state.search.playlists.items.slice(0,5).filter(function(t){return e.props.showUnplayable||t.tracks.length&&t.tracks[0].track.preview_url}).map(function(t){return n.a.createElement($,{key:t.id,search:!0,type:"playlist",id:t.id,selected:e.state.selected&&"playlists"===e.state.selected.context&&e.state.selected.id===t.id,size:"xs",images:t.images,label:Object(h.shortenString)(t.name,35),handleClick:function(a){e.updateSelected("playlists",t.id),e.props.addToFeed(e.props.id,{type:"playlist",id:t.id}),t.tracks.length&&e.props.addToQueue(t.tracks[0].track.id),e.props.activateDeactivateHoverAudio(!0)},audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,previewUrl:t.tracks.length?t.tracks[0].track.preview_url:null,captionData:{track_name:t.tracks[0].track.name,track_artist_name:t.tracks[0].track.artists.map(function(e){return e.name}).reduce(function(e,a,i){return[e,i===t.tracks[0].track.artists.length-1?" & ":", ",a].join("")}),playlist_name:t.name}})}):n.a.createElement("div",{className:"info"},"No results"),s=this.state.search.genres.items.length?this.state.search.genres.items.map(function(t){var a=e.state.selected&&"genres"===e.state.selected.context&&e.state.selected.id===t.id?"selected":"";return n.a.createElement("div",{className:"view-link ".concat(a),onClick:function(){e.updateSelected("genres",t.id),e.props.addToFeed(e.props.id,{type:"playlist",id:t.id})},key:t.name},t.name)}):n.a.createElement("div",{className:"info"},"No results");return n.a.createElement("div",null,n.a.createElement("div",{className:"titleSection"},n.a.createElement("h1",{className:"playlist-name"},this.props.id)),n.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"50% 50%",gridRowGap:"16px"}},n.a.createElement("div",{style:{gridColumn:"1/2",gridRow:"1/2"}},n.a.createElement("h4",null,"Songs"),t),n.a.createElement("div",{style:{gridColumn:"2/3",gridRow:"1/2"}},n.a.createElement("h4",null," Artists"),i),n.a.createElement("div",{style:{gridColumn:"1/2",gridRow:"2/3"}},n.a.createElement("h4",null," Albums"),a),n.a.createElement("div",{style:{gridColumn:"2/3",gridRow:"2/3"}},n.a.createElement("h4",null," Playlists"),r),n.a.createElement("div",{style:{gridColumn:"1/3",gridRow:"3/4"}},n.a.createElement("h4",null," Genres"),n.a.createElement("div",{className:"info",style:{columnCount:4}},s))))}}]),t}(i.Component);var ke=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={selected:null},a.handleAlbumsToggle=a.handleAlbumsToggle.bind(Object(m.a)(Object(m.a)(a))),a.handleSort=a.handleSort.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.albumListType,i=t.API,n=t.id,r=[{id:"popularity",name:"Sort by popularity (least to most)"},{id:"artist",name:"Sort by artist"},{id:"album",name:"Sort by album"},{id:"releaseDate",name:"Sort by release date (recent to old)"},{id:"numTracks",name:"Sort by number of tracks (most to least)"},{id:"numArtists",name:"Sort by number of artists (most to least)"}];"saved albums"===a?(r.splice(0,0,{id:"saveDate",name:"Your save date"}),i.getEntity("saved albums").then(function(t){var a=t.items.map(function(e){return{id:e.album.id}});i.getEntity("albumlist",n,null,a).then(function(t){e.setState({albumlist:t,filteredAlbumList:t})})})):"new releases"===a&&i.getEntity("new releases").then(function(t){var a=t.items.map(function(e){return{id:e.id}});i.getEntity("albumlist",n,null,a).then(function(t){e.setState({albumlist:t,filteredAlbumList:t})})}),this.setState({sortOptions:r,toggleOption:"all"}),this.setState({currentSortOption:"saved albums"===e.props.albumListType?"saveDate":"releaseDate"})}},{key:"handleAlbumsToggle",value:function(e){var t=this.state.albumlist;this.setState({toggleOption:e,filteredAlbumList:"all"===e?t:t.filter(function(t){return t.album_type===e})})}},{key:"handleSort",value:function(e){this.setState({currentSortOption:e})}},{key:"updateSelected",value:function(e){this.setState({selected:e})}},{key:"render",value:function(){var e=this,t=this.state,a=t.toggleOption,i=t.albumlist,r=t.filteredAlbumList,s=t.currentSortOption,o=t.sortOptions,l=t.selected,c=this.props,d=c.showUnplayable,u=c.id,m=c.audio,p=c.nowPlaying,v=c.addToFeed,f=c.addToQueue,y=c.activateDeactivateHoverAudio,g=c.hoverDeactivated;if(!i)return n.a.createElement("div",{className:"loading"},"Loading albums",n.a.createElement("span",null,"."),n.a.createElement("span",null,"."),n.a.createElement("span",null,"."));var k=0===i.length?n.a.createElement("div",{className:"loading"},"No saved albums."):"",w=r?function(e,t){switch(t){case"popularity":return e.sort(function(e,t){return e.popularity<t.popularity?-1:1});case"artist":return e.sort(function(e,t){return e.artists[0]&&t.artists[0]&&e.artists[0].name.toLowerCase()<t.artists[0].name.toLowerCase()?-1:1});case"album":return e.sort(function(e,t){return e.name&&t.name&&e.name.toLowerCase()<t.name.toLowerCase()?-1:1});case"releaseDate":return e.sort(function(e,t){return e.release_date&&t.release_date?Object(h.epochTimeReleaseDate)(e)<Object(h.epochTimeReleaseDate)(t)?1:Object(h.epochTimeReleaseDate)(e)>Object(h.epochTimeReleaseDate)(t)?-1:e.name.toLowerCase()<t.name.toLowerCase()?-1:1:1});case"saveDate":return e.sort(function(e,t){return e.album_list_order<t.album_list_order?-1:1});case"numTracks":return e.sort(function(e,t){return e.total_tracks>t.total_tracks?-1:1});case"numArtists":return e.sort(function(e,t){return e.artists.length>t.artists.length?-1:1});default:return e.sort(function(e,t){return e.name&&t.name&&e.name.toLowerCase()<t.name.toLowerCase()?-1:1})}}(r,s).filter(function(e){return d||e.tracks.items.length&&e.tracks.items[0].preview_url}).map(function(e){return{id:e.id,type:"track",images:e.images,preview_url:e.tracks.items.length?e.tracks.items[0].preview_url:null,artistId:e.artists[0].id,trackId:e.tracks.items[0].id,album:e}}):"",b=u,E=n.a.createElement("div",{className:"info vertical-space-below-sm"},n.a.createElement("span",{role:"link",onClick:function(){e.handleAlbumsToggle("all")},className:"view-link time-toggle ".concat("all"===a?"time-toggle-selected":"")},"All"),n.a.createElement("span",{role:"link",onClick:function(){e.handleAlbumsToggle("album")},className:"view-link time-toggle ".concat("album"===a?"time-toggle-selected":"")},"Albums"),n.a.createElement("span",{role:"link",onClick:function(){e.handleAlbumsToggle("single")},className:"view-link time-toggle ".concat("single"===a?"time-toggle-selected":"")},"Singles"),n.a.createElement("span",{role:"link",onClick:function(){e.handleAlbumsToggle("compilation")},className:"view-link time-toggle ".concat("compilation"===a?"time-toggle-selected":"")},"Compilations"));return n.a.createElement("div",{className:"playlistView"},n.a.createElement("div",{className:"header"},n.a.createElement("div",{className:"titleSection"},n.a.createElement("h1",{className:"playlist-name"},b),n.a.createElement("div",{className:"info"},n.a.createElement("div",{style:{float:"right",marginTop:"-25px"},className:"selectLight"},n.a.createElement(ne,{instance:"sortOptions",options:o,value:s,handleChange:this.handleSort,width:160}))))),n.a.createElement("div",{className:"body"},E,k,n.a.createElement(pe,{gridType:"album",audio:m,hoverDeactivated:g,nowPlaying:p,width:window.settings.feedGridSize[0],height:window.settings.feedGridSize[1],items:w,selected:l,handleClick:function(t){e.updateSelected(t.id),v(u,[{type:"album",id:t.id}]),f(t.trackId),y(!0)}})))}}]),t}(i.Component);var we=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={refreshing:!1},a.fetchData=a.fetchData.bind(Object(m.a)(Object(m.a)(a))),a.handleRefresh=a.handleRefresh.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetchData();var e=[{id:"name",name:"Sort by name"},{id:"popularity",name:"Popularity (least to most)"},{id:"followers",name:"Followers (least to most)"}];this.props.topArtists&&e.splice(0,0,{id:"affinity",name:"Sort by affinity"}),this.setState({sortOptions:e}),this.setState({currentSortOption:this.props.topArtists?"affinity":"name"})}},{key:"fetchData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,a=this.props,i=a.topArtists,n=a.API;t.setState({refreshing:!0}),i?(e&&n.invalidateCache("top artists"),n.getEntity("top artists").then(function(e){t.setState({refreshing:!1,artistlist:e.short_term,timeRange:"short_term",topTrackLookup:e})})):(e&&n.invalidateCache("followed artists"),n.getEntity("followed artists").then(function(e){t.setState({refreshing:!1,artistlist:e})}))}},{key:"handleSort",value:function(e){this.setState({currentSortOption:e})}},{key:"handleTimeRangeToggle",value:function(e){var t=this.state.topTrackLookup;this.setState({artistlist:t[e],timeRange:e})}},{key:"handleRefresh",value:function(){this.fetchData(!0)}},{key:"updateSelected",value:function(e){this.setState({selected:e})}},{key:"render",value:function(){var e=this,t=this.props,a=t.id,i=t.topArtists,r=t.audio,s=t.nowPlaying,o=t.addToFeed,l=t.addToQueue,c=t.activateDeactivateHoverAudio,d=t.hoverDeactivated,u=this.state,m=u.artistlist,p=u.timeRange,h=u.sortOptions,v=u.currentSortOption,f=u.refreshing,y=u.selected;if(!m)return n.a.createElement("div",{className:"loading"},"Loading artists",n.a.createElement("span",null,"."),n.a.createElement("span",null,"."),n.a.createElement("span",null,"."));var g=0===m.items.length&&i?n.a.createElement("div",{className:"loading"},"No top artists for this time period."):0===m.items.length?n.a.createElement("div",{className:"loading"},"No followed artists."):"",k=i?"Your Top Artists":"Your Followed Artists",w=i?n.a.createElement("div",null,n.a.createElement("span",{onClick:function(t){e.handleTimeRangeToggle("short_term")},className:"view-link time-toggle ".concat("short_term"===p?"time-toggle-selected":"")},"Last Month"),n.a.createElement("span",{onClick:function(t){e.handleTimeRangeToggle("medium_term")},className:"view-link time-toggle ".concat("medium_term"===p?"time-toggle-selected":"")},"Last 6 Months"),n.a.createElement("span",{onClick:function(t){e.handleTimeRangeToggle("long_term")},className:"view-link time-toggle ".concat("long_term"===p?"time-toggle-selected":"")},"All Time")):"",b=m?function(e,t){switch(t){case"popularity":return e.sort(function(e,t){return e.popularity<t.popularity?-1:1});case"followers":return e.sort(function(e,t){return e.followers&&t.followers&&e.followers.total<t.followers.total?-1:1});case"name":return e.sort(function(e,t){return e.name&&t.name?e.name.toLowerCase()<t.name.toLowerCase()?-1:1:-1});case"affinity":return e.sort(function(e,t){return e.affinity_rank<t.affinity_rank?-1:1});default:return e.sort(function(e,t){return e.name&&t.name?e.name.toLowerCase()<t.name.toLowerCase()?-1:1:-1})}}(m.items,v).map(function(e){return{id:e.id,type:"artist",images:e.images.length?e.images:e.topTracks.length?e.topTracks[0].album.images:[],preview_url:e.topTracks.length?e.topTracks[0].preview_url:null,trackId:e.topTracks.length?e.topTracks[0].id:null,artist:e}}):"";return n.a.createElement("div",{className:"playlistView"},n.a.createElement("div",{className:"header"},n.a.createElement("div",{className:"titleSection"},n.a.createElement("h1",{className:"playlist-name"},k,n.a.createElement(fe,{handleClick:this.handleRefresh,refreshing:f})),n.a.createElement("div",{className:"info"},i?w:""),n.a.createElement("div",{className:"info"},n.a.createElement("div",{style:{float:"right",marginTop:"-25px"},className:"selectLight"},n.a.createElement(ne,{instance:"sortOptions",options:h,value:v,handleChange:this.handleSort.bind(this),width:160}))))),n.a.createElement("div",{className:"body"},g,n.a.createElement(pe,{audio:r,nowPlaying:s,hoverDeactivated:d,width:window.settings.feedGridSize[0],height:window.settings.feedGridSize[1],gridType:"artist",selected:y,items:b,handleClick:function(t){e.updateSelected(t.id),o(a,[{type:"artist",id:t.id}]),l(t.trackId),c(!0)}})))}}]),t}(i.Component),be=a(47),Ee=a.n(be),Pe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={selected:null,filterValue:"",sortBy:"alphabetical",refreshing:!1},a.fetchData=a.fetchData.bind(Object(m.a)(Object(m.a)(a))),a.handleFilter=a.handleFilter.bind(Object(m.a)(Object(m.a)(a))),a.clearFilter=a.clearFilter.bind(Object(m.a)(Object(m.a)(a))),a.handleClickArtist=a.handleClickArtist.bind(Object(m.a)(Object(m.a)(a))),a.handleYourPlaylistsToggle=a.handleYourPlaylistsToggle.bind(Object(m.a)(Object(m.a)(a))),a.handleRefresh=a.handleRefresh.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"getGenreScores",value:function(e){var t=new Map;for(var a in e)e[a].items.forEach(function(e){e.genres.forEach(function(a){t.has(a)||t.set(a,{score:0,artists:new Map}),t.get(a).score++,t.get(a).artists.set(e.id,e)})});return t.forEach(function(e){e.artists=Array.from(e.artists.values())}),t}},{key:"fetchData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,a=this.props,i=a.type,n=a.API,r=a.addToFeed,s=a.id;t.setState({refreshing:!0}),"genres"===i?(e&&(n.invalidateCache("top artists"),n.invalidateCache("genrePlaylists")),t.setState({title:"Genres",columnCount:4,toggleOption:"all"}),n.getEntity("top artists").then(function(e){var a=t.getGenreScores(e);n.getEntity("genrePlaylists").then(function(e){var i=e.items.map(function(e){return e.userScore=a.has(e.name)?a.get(e.name).score:null,e.items=a.has(e.name)?a.get(e.name).artists:null,e.click=function(){r(t.props.id,{type:"playlist",id:e.id})},e});t.setState({refreshing:!1,items:i})})})):"spotifyPlaylists"===i?(e&&n.invalidateCache("categories"),t.setState({title:"Spotify Playlists",columnCount:1,sortBy:"sourceOrder"}),n.getEntity("categories").then(function(e){e.allPlaylists.forEach(function(e){e.click=function(){r(s,{type:"playlist",id:e.id})}}),t.setState({refreshing:!1,items:e.byCategory})})):"yourPlaylists"===i?(e&&n.invalidateCache("ownPlaylists"),t.setState({title:"Your Playlists",columnCount:3,sortBy:"sourceOrder",toggleOption:"all"}),n.getEntity("own profile",null).then(function(e){n.getEntity("ownPlaylists",null).then(function(a){t.setState({refreshing:!1,ownProfile:e,items:a.items.map(function(e){return e.click=function(){r(s,{type:"playlist",id:e.id})},e})})})})):"charts"===i&&(e&&n.invalidateCache("charts"),t.setState({title:"Charts",columnCount:4,sortBy:"sourceOrder",toggleOption:"all",chartType:"top"}),n.getEntity("charts",null).then(function(e){e.forEach(function(e){e.click=function(){r(s,{type:"playlist",id:e.id})};var t=e.name.split(" ");e.name=t.slice(0,t.length-2).join(" ")});var a=e.sort(function(e,t){return"Global"===e.name||"Global"===t.name?1:e.name.toLowerCase()<t.name.toLowerCase()?-1:1});t.setState({refreshing:!1,items:a,toggleOption:"top",toggleFilterFunction:function(e){return"top"===e.list_type}})}))}},{key:"handleGenreToggle",value:function(e){"user"===e?this.setState({toggleOption:e,toggleFilterFunction:function(e){return e.userScore>0},sortBy:"userScore",columnCount:1}):this.setState({toggleOption:e,toggleFilterFunction:null,sortBy:"alphabetical",columnCount:4})}},{key:"handleYourPlaylistsToggle",value:function(e){var t=this.state.ownProfile;"own"===e?this.setState({toggleOption:e,toggleFilterFunction:function(e){return t&&e.owner.id===t.id}}):"follow"===e?this.setState({toggleOption:e,toggleFilterFunction:function(e){return t&&e.owner.id!==t.id}}):this.setState({toggleOption:e,toggleFilterFunction:null})}},{key:"handleChartsToggle",value:function(e){this.setState({toggleOption:e,toggleFilterFunction:function(t){return t.list_type===e}})}},{key:"handleClickArtist",value:function(e){var t=this.props,a=t.addToFeed,i=t.id;this.updateSelected(e),a(i,{type:"artist",id:e})}},{key:"updateSelected",value:function(e){this.setState({selected:e})}},{key:"handleFilter",value:function(e){var t=e.target.value;this.setState({filterValue:t}),e.preventDefault()}},{key:"handleRefresh",value:function(){this.fetchData(!0)}},{key:"clearFilter",value:function(){this.setState({filterValue:""})}},{key:"render",value:function(){var e,t=this,a=this.props.type,i=this.state,r=i.items,s=i.title,o=i.filterValue,l=i.toggleOption,c=i.toggleFilterFunction,d=i.sortBy,u=i.selected,m=i.columnCount,p=i.refreshing,h=o.length>0,v="genres"===a&&"user"===l,f="";"genres"===a?f=n.a.createElement("div",{className:"info vertical-space-below-sm"},n.a.createElement("span",{role:"link",onClick:function(e){t.handleGenreToggle("all")},className:"view-link time-toggle ".concat("all"===l?"time-toggle-selected":"")},"All Genres"),n.a.createElement("span",{role:"link",onClick:function(e){t.handleGenreToggle("user")},className:"view-link time-toggle ".concat("user"===l?"time-toggle-selected":"")},"Genres You Like"),n.a.createElement("span",{className:"everynoise"},"Learn more about Spotify genres at ",n.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"http://everynoise.com/"},"everynoise.com"))):"yourPlaylists"===a?f=n.a.createElement("div",{className:"info vertical-space-below-sm"},n.a.createElement("span",{role:"link",onClick:function(e){t.handleYourPlaylistsToggle("all")},className:"view-link time-toggle ".concat("all"===l?"time-toggle-selected":"")},"All"),n.a.createElement("span",{role:"link",onClick:function(e){t.handleYourPlaylistsToggle("own")},className:"view-link time-toggle ".concat("own"===l?"time-toggle-selected":"")},"Playlists You Own"),n.a.createElement("span",{role:"link",onClick:function(e){t.handleYourPlaylistsToggle("follow")},className:"view-link time-toggle ".concat("follow"===l?"time-toggle-selected":"")},"Playlists You Follow")):"charts"===a&&(f=n.a.createElement("div",{className:"info vertical-space-below-sm"},n.a.createElement("span",{role:"link",onClick:function(e){t.handleChartsToggle("top")},className:"view-link time-toggle ".concat("top"===l?"time-toggle-selected":"")},"Top 50"),n.a.createElement("span",{role:"link",onClick:function(e){t.handleChartsToggle("viral")},className:"view-link time-toggle ".concat("viral"===l?"time-toggle-selected":"")},"Viral 50"))),e="userScore"===d?function(e,t){return t.userScore-e.userScore}:"sourceOrder"===d?function(e,t){return e.sourceOrder-t.sourceOrder}:function(e,t){return e.name<t.name?-1:1};var y,g=function(e,t){return e.toLowerCase().indexOf(t.toLowerCase())>-1};y="spotifyPlaylists"===a?function(e){var a=e.itemsFiltered.map(function(e){var a=e.id===u?"selected view-link":"view-link";return n.a.createElement("div",{key:e.id},n.a.createElement("span",{role:"link",className:a,onClick:function(a){t.updateSelected(e.id),e.click(a)}},e.name))});return n.a.createElement("div",{key:e.id,className:"vertical-space-below-md"},n.a.createElement("h2",null,e.name),n.a.createElement("div",{style:{columnCount:4,columnGap:"16px"}},a))}:function(e){var a=e.id===u?"selected view-link":"view-link",i=v&&e.itemsFiltered?n.a.createElement("div",{className:"artistList info"},e.itemsFiltered.map(function(e){return n.a.createElement("span",{className:"view-link",onClick:function(a){t.handleClickArtist(e.id)}},e.name)}).reduce(function(e,t){return[e,", ",t]})):"";return"title"===e.type?n.a.createElement("h3",null,e.name):n.a.createElement("div",{key:e.id},n.a.createElement("span",{className:a,onClick:function(a){t.updateSelected(e.id),e.click(a)}},e.name),i)};var k=r?r.filter(function(e){return!(c&&!c(e))&&(h?g(e.name,o)?(e.itemsFiltered=e.items,!0):!!(e.items&&(e.itemsFiltered=e.items.filter(function(e){return g(e.name,o)}),e.itemsFiltered.length>0)):(e.itemsFiltered=e.items,!0))}).sort(e).map(y):n.a.createElement("div",{className:"loading"},"Loading",n.a.createElement("span",null,"."),n.a.createElement("span",null,"."),n.a.createElement("span",null,"."),"'"),w=h?n.a.createElement("img",{alt:"clear search",onClick:this.clearFilter,style:{position:"absolute",margin:"3px 0 0 -22px"},src:Ee.a,className:"closeButton"}):"",b=Array.isArray(r)&&0===r.length?n.a.createElement("div",{className:"loading"},"No playlists",n.a.createElement("em",null,o)):"";return n.a.createElement("div",{className:"textlistView"},n.a.createElement("div",{className:"header flex-container",style:{alignItems:"flex-end"}},n.a.createElement("div",{className:"titleSection",style:{flexGrow:5}},n.a.createElement("h1",null,s,n.a.createElement(fe,{handleClick:this.handleRefresh,refreshing:p}))),n.a.createElement("div",{style:{margin:"0 0 10px 16px"},className:"selectLight"},n.a.createElement("input",{className:"search-bar",value:o,onChange:this.handleFilter,placeholder:"Filter",type:"text"}),w)),f,n.a.createElement("div",{className:"body"},n.a.createElement("div",{className:"fade"}),n.a.createElement("div",{className:"innerScroll"},n.a.createElement("div",{style:{columnCount:m,columnGap:"16px"}},k,b))))}}]),t}(i.Component),Se=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.items.length>0?this.props.items.map(function(t,a){var i;return"artist"===t.type?i=n.a.createElement(de,{API:e.props.API,saveOrFollow:e.props.saveOrFollow,addToFeed:e.props.addToFeed,addToQueue:e.props.addToQueue,audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,id:t.id,activateDeactivateHoverAudio:e.props.activateDeactivateHoverAudio,showUnplayable:e.props.showUnplayable,incrementStat:e.props.incrementStat}):"track"===t.type?i=n.a.createElement(ce,{API:e.props.API,saveOrFollow:e.props.saveOrFollow,addToFeed:e.props.addToFeed,addToQueue:e.props.addToQueue,audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,id:t.id,activateDeactivateHoverAudio:e.props.activateDeactivateHoverAudio,showUnplayable:e.props.showUnplayable,incrementStat:e.props.incrementStat,ownPlaylists:e.props.ownPlaylists,updateOwnPlaylists:e.props.updateOwnPlaylists}):"album"===t.type?i=n.a.createElement(ue,{API:e.props.API,saveOrFollow:e.props.saveOrFollow,addToFeed:e.props.addToFeed,addToQueue:e.props.addToQueue,audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,id:t.id,activateDeactivateHoverAudio:e.props.activateDeactivateHoverAudio,showUnplayable:e.props.showUnplayable,incrementStat:e.props.incrementStat}):"playlist"===t.type?i=n.a.createElement(ye,{API:e.props.API,saveOrFollow:e.props.saveOrFollow,addToFeed:e.props.addToFeed,addToQueue:e.props.addToQueue,audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,id:t.id,activateDeactivateHoverAudio:e.props.activateDeactivateHoverAudio,updateOwnPlaylists:e.props.updateOwnPlaylists,showUnplayable:e.props.showUnplayable,incrementStat:e.props.incrementStat}):"magic"===t.type?i=n.a.createElement(ye,{API:e.props.API,saveOrFollow:e.props.saveOrFollow,addToFeed:e.props.addToFeed,addToQueue:e.props.addToQueue,audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,id:t.id,activateDeactivateHoverAudio:e.props.activateDeactivateHoverAudio,updateOwnPlaylists:e.props.updateOwnPlaylists,seed:t.seed,generatedFrom:t.generatedFrom,showUnplayable:e.props.showUnplayable,incrementStat:e.props.incrementStat}):"saved tracks"===t.type?i=n.a.createElement(ye,{API:e.props.API,saveOrFollow:e.props.saveOrFollow,addToFeed:e.props.addToFeed,addToQueue:e.props.addToQueue,audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,id:t.id,activateDeactivateHoverAudio:e.props.activateDeactivateHoverAudio,updateOwnPlaylists:e.props.updateOwnPlaylists,savedTracks:!0,showUnplayable:e.props.showUnplayable,incrementStat:e.props.incrementStat}):"top tracks"===t.type?i=n.a.createElement(ye,{API:e.props.API,saveOrFollow:e.props.saveOrFollow,addToFeed:e.props.addToFeed,addToQueue:e.props.addToQueue,audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,id:t.id,activateDeactivateHoverAudio:e.props.activateDeactivateHoverAudio,updateOwnPlaylists:e.props.updateOwnPlaylists,topTracks:!0,showUnplayable:e.props.showUnplayable,incrementStat:e.props.incrementStat}):"top artists"===t.type?i=n.a.createElement(we,{API:e.props.API,saveOrFollow:e.props.saveOrFollow,addToFeed:e.props.addToFeed,addToQueue:e.props.addToQueue,audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,id:t.id,activateDeactivateHoverAudio:e.props.activateDeactivateHoverAudio,topArtists:!0,showUnplayable:e.props.showUnplayable,incrementStat:e.props.incrementStat}):"followed artists"===t.type?i=n.a.createElement(we,{API:e.props.API,saveOrFollow:e.props.saveOrFollow,addToFeed:e.props.addToFeed,addToQueue:e.props.addToQueue,audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,id:t.id,activateDeactivateHoverAudio:e.props.activateDeactivateHoverAudio,showUnplayable:e.props.showUnplayable}):"search"===t.type?i=n.a.createElement(ge,{API:e.props.API,addToFeed:e.props.addToFeed,addToQueue:e.props.addToQueue,audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,activateDeactivateHoverAudio:e.props.activateDeactivateHoverAudio,showUnplayable:e.props.showUnplayable,id:t.id}):"new releases"===t.type?i=n.a.createElement(ke,{API:e.props.API,addToFeed:e.props.addToFeed,addToQueue:e.props.addToQueue,audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,activateDeactivateHoverAudio:e.props.activateDeactivateHoverAudio,id:t.id,albumListType:t.type,showUnplayable:e.props.showUnplayable}):"saved albums"===t.type?i=n.a.createElement(ke,{API:e.props.API,addToFeed:e.props.addToFeed,addToQueue:e.props.addToQueue,audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,activateDeactivateHoverAudio:e.props.activateDeactivateHoverAudio,id:t.id,albumListType:t.type,showUnplayable:e.props.showUnplayable}):"text list"===t.type&&(i=n.a.createElement(Pe,{API:e.props.API,addToFeed:e.props.addToFeed,addToQueue:e.props.addToQueue,audio:e.props.audio,hoverDeactivated:e.props.hoverDeactivated,nowPlaying:e.props.nowPlaying,activateDeactivateHoverAudio:e.props.activateDeactivateHoverAudio,id:t.id,type:t.id.substr(5),showUnplayable:e.props.showUnplayable})),n.a.createElement(W,{key:t.key,id:t.id,type:t.type,firstInFeed:0===a,firstOfMultipleCards:t.firstOfMultipleCards,lastOfMultipleCards:t.lastOfMultipleCards,scrolledDown:e.props.scrolledDown,handleClose:function(a){return e.props.removeFromFeed(t.key)}},i)}):n.a.createElement("div",{className:"emptyFeed"},"Loading metadata and finding a place to start...");return n.a.createElement("div",null,t)}}]),t}(i.Component),Oe=a(48),Te=a.n(Oe),Ae=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.track,a=e.audio,i=e.removeFromQueue,r=e.API,s=e.itemKey,o=e.hoverDeactivated,l=e.nowPlaying,c=e.playing;if(!t)return n.a.createElement("div",{className:"queue-item loading"},"Adding track...");var d="queueItem playOverlayTrigger";return!0===c&&(d+=" playing"),n.a.createElement("div",{className:d,onClick:function(e){window.playerError||a("play track",t.id,t.uri)}},n.a.createElement($,{type:"track",id:t.id,size:"xs",images:t.album.images,audio:a,hoverDeactivated:o,nowPlaying:l,previewUrl:t.preview_url,showPlayerButton:!0,playing:c,preventPreview:!0,captionData:{track_name:t.name,track_artist_name:t.artists.map(function(e){return e.name}).reduce(function(e,a,i){return[e,i===t.artists.length-1?" & ":", ",a].join("")})}}),n.a.createElement("img",{alt:"remove from queue",onClick:function(e){i(s),r.pauseTrack(),e.stopPropagation()},style:{right:"9px",top:"12px"},src:Te.a,className:"closeButton"}),n.a.createElement("div",{className:"trackInfo"},v.a.shortenString(t.name,100),n.a.createElement("div",{className:"artist"},v.a.shortenString(t.artists[0].name,90))))}}]),t}(i.Component),_e=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={open:!1,items:[]},a.handleAddToPlaylist=a.handleAddToPlaylist.bind(Object(m.a)(Object(m.a)(a))),a.handleSaveToLibrary=a.handleSaveToLibrary.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillReceiveProps",value:function(){var e=this;this.props.items.length>0?e.props.API.getEntity("trackShallow",e.props.items.map(function(e){return e.id})).then(function(t){Array.isArray(t)||(t=[t]);var a=[];e.props.items.forEach(function(i,n){n>0&&i.root!==e.props.items[n-1].root&&a.push({id:"divider"}),a.push(t.find(function(e){return e.id===i.id}))}),e.setState({items:a})}):e.setState({items:[]})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"handleAddToPlaylist",value:function(e){var t=this,a=this.props,i=a.API,n=a.updateOwnPlaylists,r=a.incrementStat,s=this.state.items;if(!s||0===s.length)return t.setState({alertPlaylistAction:!0,errorMessage:"There are no tracks in your queue to save!"}),void setTimeout(function(){t.setState({alertPlaylistAction:!1,errorMessage:!1})},5e3);var o=s.map(function(e){return e.uri});if("new"===e){var l=window.prompt("Name for your playlist:","Discovered Quickly");i.modifyPlaylist("create playlist",null,{name:l,tracks:o}).then(function(){t.setState({alertPlaylistAction:!0,numItemsAdded:s.length,newPlaylist:!0}),n(!0),setTimeout(function(){t.setState({alertPlaylistAction:!1,newPlaylist:!1})},5e3)},function(e){console.log(e),alert("Error adding to playlist! You may need to refresh the page and try again: it's okay, your queue will still be here.")})}else e.length>5&&i.modifyPlaylist("add to playlist",e,{tracks:o}).then(function(){t.setState({alertPlaylistAction:!0,numItemsAdded:s.length,newPlaylist:!1}),r("numTracksAddedToPlaylists",s.length),n(!0),setTimeout(function(){t.setState({alertPlaylistAction:!1})},5e3)},function(e){console.log(e),alert("Error creating new playlist! You may need to refresh the page and try again: it's okay, your queue will still be here.")})}},{key:"handleSaveToLibrary",value:function(e){var t=this,a=e.map(function(e){return e.id}).filter(function(e){return"divider"!==e});t.props.API.saveOrFollowEntity("track",a).then(function(e){a.forEach(function(e){return t.props.API.invalidateCache("track",e)}),t.props.incrementStat("numSavedTracks",a.length),t.setState({alertPlaylistAction:!0,numItemsAdded:a.length,savedToLibrary:!0}),setTimeout(function(){t.setState({alertPlaylistAction:!1,savedToLibrary:!1})},5e3)})}},{key:"render",value:function(){var e=this,t=this.props,a=t.open,i=t.ownPlaylists,r=t.userId,s=t.API,o=t.audio,l=t.hoverDeactivated,c=t.nowPlaying,d=t.removeFromQueue,u=t.playing,m=t.windowHeight,p=t.toggleQueue,h=this.state,v=h.items,f=h.alertPlaylistAction,y=h.errorMessage,g=h.numItemsAdded,k=h.newPlaylist,w=h.savedToLibrary;if(!a)return"";var b,E,P,S=[{id:"",name:"Add all to playlist..."},{id:"new",name:"<New Playlist>"},{id:"-",name:""}];i?i.filter(function(e){return e.owner.id===r||e.collaborative}).forEach(function(e){S.push({id:e.id,name:e.name})}):S.push({id:"load",name:"Loading playlists..."}),v&&v.length>0?(b=v.map(function(e,t){return e&&"divider"===e.id?n.a.createElement("hr",{key:"hr-".concat(e,"-").concat(t)}):e?n.a.createElement(Ae,{API:s,audio:o,hoverDeactivated:l,nowPlaying:c,key:e.id,itemKey:e.id,track:e,removeFromQueue:d,playing:u===e.id}):""}),P="premium"!==window.product||window.playerError?"premium"===window.product&&window.playerError?n.a.createElement("div",{className:"explanation"},n.a.createElement("em",null,"Full track playback not supported in this browser. Try Chrome, or save these tracks above to listen in the main Spotify app"),". "):"premium"!==window.product?n.a.createElement("div",{className:"explanation"},n.a.createElement("em",null,"Spotify Premium required to play the full song in Discover Quickly. Save these tracks above to listen in the main Spotify app"),"."):"":n.a.createElement("div",{className:"explanation"},"Click a track to play the full song "),E=n.a.createElement("span",{className:"info clearButton view-link",onClick:function(){d("all")}},"clear all")):(b=n.a.createElement("div",{className:"queueEmpty"},n.a.createElement("p",null,"Songs you click on will be saved here!")),P="",E="");var O=n.a.createElement("div",{className:"close-button view-link",onClick:p},"close"),T=f&&y?n.a.createElement("p",{className:"playlist-add-success-alert"},y):f?n.a.createElement("p",{className:"playlist-add-success-alert"},g," ","track",g>1?"s":""," ","added",k?" to your new playlist":w?" to your library":"","!"):"";return n.a.createElement("div",{id:"queueContainer"},n.a.createElement("div",{className:"modal-transparency queue-transparency",onClick:p}),n.a.createElement("div",{id:"queueOuter"},n.a.createElement("div",{id:"queue",className:"inverted darker-bg"},n.a.createElement("div",{className:"queueHeader"},n.a.createElement("div",{className:"options"},n.a.createElement("span",{className:"button view-link inverted",style:{textAlign:"right"},onClick:function(){e.handleSaveToLibrary(e.state.items)}},"Save all tracks"),n.a.createElement(ne,{instance:"saveOptions",options:S,handleChange:this.handleAddToPlaylist,value:""}),T,E)),n.a.createElement("div",{className:"queueItems",style:{maxHeight:"".concat(Math.max(m-260,50),"px")}},b),O,P)))}}]),t}(i.Component),Ce=a(49),je=a.n(Ce),Ne=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={open:!1},a.toggleOpen=a.toggleOpen.bind(Object(m.a)(Object(m.a)(a))),a.setWrapperRef=a.setWrapperRef.bind(Object(m.a)(Object(m.a)(a))),a.handleClickOutside=a.handleClickOutside.bind(Object(m.a)(Object(m.a)(a))),a.handleRestart=a.handleRestart.bind(Object(m.a)(Object(m.a)(a))),a.logout=a.logout.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"setWrapperRef",value:function(e){this.wrapperRef=e}},{key:"logout",value:function(){var e=this.props.API,t=window.open("https://www.spotify.com/logout");localStorage.removeItem("accessToken"),localStorage.removeItem("accessExpires"),e.invalidateCache("all"),setTimeout(function(){t.close(),window.location.hash="",window.location.reload()},2e3)}},{key:"toggleOpen",value:function(e){this.setState({open:e}),e&&window.gtag("event","viewed settings",{event_category:"navigation"})}},{key:"handleClickOutside",value:function(e){this.wrapperRef&&!this.wrapperRef.contains(e.target)&&this.state.open&&this.toggleOpen(!1)}},{key:"handleRestart",value:function(){this.props.API.invalidateCache("all"),window.location.reload()}},{key:"render",value:function(){var e=this,t=this.props,a=t.showAbout,i=t.showUnplayable,r=t.audioPreview,s=t.openLinksInBrowser,o=t.showStats,l=this.state.open?n.a.createElement("div",{className:"openPanel inverted"},n.a.createElement("div",{className:"panelRow"},n.a.createElement("span",{className:"view-link",onClick:a},"About this project")),n.a.createElement("div",{className:"panelRow"},n.a.createElement("label",null,n.a.createElement("input",{className:"checkbox",type:"checkbox",checked:i,onChange:function(){e.props.changeSetting("showUnplayable",!e.props.showUnplayable)}}),"Show unplayable tracks")),n.a.createElement("div",{className:"panelRow"},n.a.createElement("label",null,n.a.createElement("input",{className:"checkbox",type:"checkbox",checked:r,onChange:function(){e.props.changeSetting("audioPreview",!e.props.audioPreview)}}),"Audio preview")),n.a.createElement("div",{className:"panelRow"},n.a.createElement("label",null,n.a.createElement("input",{className:"checkbox",type:"checkbox",checked:s,onChange:function(){e.props.changeSetting("openLinksInBrowser",!e.props.openLinksInBrowser)}}),"Open Spotify links in browser")),n.a.createElement("div",{className:"panelRow"},n.a.createElement("label",null,n.a.createElement("input",{className:"checkbox",type:"checkbox",checked:o,onChange:function(){e.props.changeSetting("showStats",!e.props.showStats)}}),"Show stats")),n.a.createElement("div",{className:"panelRow"},n.a.createElement("span",{className:"view-link logout",onClick:this.handleRestart},"Clear cache & restart")),n.a.createElement("div",{className:"panelRow"},n.a.createElement("span",{className:"view-link logout",onClick:this.logout},"Log out of Spotify"))):"";return n.a.createElement("div",{id:"settings",className:this.state.open?"open":"",ref:this.setWrapperRef},n.a.createElement("img",{src:je.a,alt:"Show settings",className:"toggleButton view-link",onClick:function(){e.toggleOpen(!e.state.open)}}),l)}}]),t}(i.Component),Ie=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getRightSizedImage",value:function(e){var t=this.props.images;if(Array.isArray(t)&&t.length>0){var a=t.sort(function(e,t){return e.width-t.width});return a.find(function(t){return t.width>=e&&t.height>=e})||a.slice(-1)[0]}return{url:t,width:null,height:null}}},{key:"render",value:function(){var e,t=this.props,a=t.captionData,i=t.type,r=this.getRightSizedImage(400);return"track"===i?e=n.a.createElement("div",{id:"artworkCaption"},n.a.createElement("div",{className:"caption-track-name"},a.track_name),n.a.createElement("div",null,a.track_artist_name)):"artist"===i?e=n.a.createElement("div",{id:"artworkCaption"},n.a.createElement("div",{className:"caption-track-name caption-secondary"},a.track_name),n.a.createElement("div",{className:"caption-secondary"},a.track_artist_name),n.a.createElement("div",{className:"caption-section-two caption-secondary"},"The top track on Spotify for:"),n.a.createElement("div",{className:"caption-main-name"},a.artist_name)):"album"===i?e=n.a.createElement("div",{id:"artworkCaption"},n.a.createElement("div",{className:"caption-track-name caption-secondary"},a.track_name),n.a.createElement("div",{className:"caption-secondary"},a.track_artist_name),n.a.createElement("div",{className:"caption-section-two caption-secondary"},"The first track on the album:"),n.a.createElement("div",{className:"caption-main-name"},a.album_name),n.a.createElement("div",null,a.album_artist_name)):"playlist"===i&&(e=n.a.createElement("div",{id:"artworkCaption"},n.a.createElement("div",{className:"caption-track-name caption-secondary"},a.track_name),n.a.createElement("div",{className:"caption-secondary"},a.track_artist_name),n.a.createElement("div",{className:"caption-section-two caption-secondary"},"The first track on the playlist:"),n.a.createElement("div",{className:"caption-main-name"},a.playlist_name))),n.a.createElement("div",{id:"artwork",className:"show"},n.a.createElement("div",{id:"artworkImg"},n.a.createElement("img",{alt:"enlarged-hovered",src:r.url,className:"now-playing-image"})),e)}}]),t}(i.Component);a(38);window.settings={sizes:{xs:24,sm:48,md:64,lg:128},feedGridSize:[723,480],gridLimit:1/0,listLimit:16,albumLimit:50,headerScrollThreshold:1};var Fe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={feed:[],queue:[],audioPreview:!0,showUnplayable:"true"===localStorage.getItem("showUnplayable"),openLinksInBrowser:"true"===localStorage.getItem("openLinksInBrowser"),magnifyArtwork:"true"===localStorage.getItem("magnifyArtwork")||!localStorage.getItem("magnifyArtwork"),showQueue:!1,showStats:"true"===localStorage.getItem("showStats"),playing:null,rateLimitMessage:"",ownPlaylists:null,discoverWeekly:null,releaseRadar:null,currentRootCategory:null,currentRootId:null,windowHeight:window.innerHeight,isScrolledDown:!1,numFollowedArtists:+localStorage.getItem("numFollowedArtists")||0,numFollowedPlaylists:+localStorage.getItem("numFollowedPlaylists")||0,numSavedAlbums:+localStorage.getItem("numSavedAlbums")||0,numSavedTracks:+localStorage.getItem("numSavedTracks")||0,numTracksAddedToPlaylists:+localStorage.getItem("numTracksAddedToPlaylists")||0,aboutModalOpen:!1,explainerFeedShown:localStorage.getItem("explainerFeedShown")||!1,explainerQueueShown:localStorage.getItem("explainerQueueShown")||!1,explainerPlaybackShown:localStorage.getItem("explainerPlaybackShown")||!1},a.API=new C(function(e,t){a.updateCurrentlyPlaying(e,t)}),window.showCache=function(){console.log(a.API.cache)},window.showState=function(){console.log(a.state)},window.addEventListener("resize",function(){a.updateWindowSizes()}),window.addEventListener("scroll",function(){a.handleWindowScroll()}),a.updateWindowSizes=a.updateWindowSizes.bind(Object(m.a)(Object(m.a)(a))),a.handleWindowScroll=a.handleWindowScroll.bind(Object(m.a)(Object(m.a)(a))),a.controlAudio=a.controlAudio.bind(Object(m.a)(Object(m.a)(a))),a.changeSetting=a.changeSetting.bind(Object(m.a)(Object(m.a)(a))),a.addToFeed=a.addToFeed.bind(Object(m.a)(Object(m.a)(a))),a.removeFromFeed=a.removeFromFeed.bind(Object(m.a)(Object(m.a)(a))),a.updateRoot=a.updateRoot.bind(Object(m.a)(Object(m.a)(a))),a.addToQueue=a.addToQueue.bind(Object(m.a)(Object(m.a)(a))),a.removeFromQueue=a.removeFromQueue.bind(Object(m.a)(Object(m.a)(a))),a.toggleQueue=a.toggleQueue.bind(Object(m.a)(Object(m.a)(a))),a.updateCurrentlyPlaying=a.updateCurrentlyPlaying.bind(Object(m.a)(Object(m.a)(a))),a.updateOwnPlaylists=a.updateOwnPlaylists.bind(Object(m.a)(Object(m.a)(a))),a.activateDeactivateHoverAudio=a.activateDeactivateHoverAudio.bind(Object(m.a)(Object(m.a)(a))),a.incrementStat=a.incrementStat.bind(Object(m.a)(Object(m.a)(a))),a.scrolledDown=a.scrolledDown.bind(Object(m.a)(Object(m.a)(a))),a.scrollToTop=a.scrollToTop.bind(Object(m.a)(Object(m.a)(a))),a.handleToggleAboutModal=a.handleToggleAboutModal.bind(Object(m.a)(Object(m.a)(a))),a.handleNowPlayingImage=a.handleNowPlayingImage.bind(Object(m.a)(Object(m.a)(a))),a.stopPreviewPlaying=a.stopPreviewPlaying.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"updateWindowSizes",value:function(){this.setState({windowHeight:window.innerHeight,windowWidth:window.innerWidth})}},{key:"handleWindowScroll",value:function(){this.setState({isScrolledDown:document.body.scrollTop>window.settings.headerScrollThreshold||document.documentElement.scrollTop>window.settings.headerScrollThreshold})}},{key:"updateExplainerState",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a="explainer".concat(e,"Shown");this.setState(Object(p.a)({},a,t)),localStorage.setItem(a,t)}},{key:"stopPreviewPlaying",value:function(){this.activateDeactivateHoverAudio(!1),this.handleNowPlayingImage(!1),this.controlAudio("stop preview")}},{key:"handleNowPlayingImage",value:function(e,t,a,i){e?this.setState({showNowPlayingImage:!0,nowPlayingImages:t,captionData:a,nowPlayingType:i}):this.setState({showNowPlayingImage:!1})}},{key:"controlAudio",value:function(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,n=this.state,r=n.audioPreview,s=n.playing;r&&"start preview"===e&&this.API.startPreview(a,this.activateDeactivateHoverAudio,i),r&&"start preview from click"===e?this.API.startPreviewFromClick(a,this.activateDeactivateHoverAudio,i):"stop preview"===e?this.API.stopPreview(a):"pause track"===e?this.API.pauseTrack():"play track"===e&&(s&&s===t?this.API.pauseTrack():(this.API.playTrack(a),window.gtag("event","play queue track",{event_category:"discovery"})))}},{key:"activateDeactivateHoverAudio",value:function(e){this.setState({hoverDeactivated:e}),e||this.updateExplainerState("Playback")}},{key:"changeSetting",value:function(e,t){var a={};a[e]=t,localStorage.setItem(e,t),this.setState(a)}},{key:"incrementStat",value:function(e,t){var a=localStorage.getItem(e),i=a?+a+t:t;localStorage.setItem(e,i);var n={};n[e]=i,this.setState(n),window.gtag("event","save follow or playlist",{event_category:"discovery",event_label:e,event_value:t})}},{key:"updateRoot",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;this.setState({currentRootCategory:e,currentRootId:t}),"search"===e&&t&&t.includes(i)||window.gtag("event",a?"initial root":"changed root",{event_category:"navigation",event_label:e})}},{key:"addToFeed",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Array.isArray(t)||(t=[t]);var i=this.state.feed;a&&i.length>0||(e?i=i.slice(0,i.findIndex(function(t){return t.id===e})+1):(i=[],t&&"search"===t[0].type&&this.updateRoot("search")),i.length>0&&this.updateExplainerState("Feed"),t.forEach(function(a,n){a.key=a.id+(new Date).getTime(),a.firstOfMultipleCards=0===n&&t.length>1,a.lastOfMultipleCards=n===t.length-1&&t.length>1,i&&i.length>0&&i[i.length-1].id===a.id||(i.push(a),e&&window.gtag("event","added to feed",{event_category:"discovery",event_label:a.type,event_value:1}))}),this.setState({feed:i}))}},{key:"removeFromFeed",value:function(e){if(e){var t=this.state.feed;t.splice(t.findIndex(function(t){return t.key===e}),1),this.setState({feed:t})}}},{key:"closeModal",value:function(){this.setState({viewedIntroModal:!0,viewedSecondaryModal:!0}),localStorage.setItem("viewedIntroModal",!0),this.controlAudio("stop preview")}},{key:"addToQueue",value:function(e){var t=this.state.queue,a=e;t.find(function(e){return e.key===a})||(t.push({key:a,id:e,root:this.state.currentRootCategory,rootId:this.state.currentRootId}),this.setState({queue:t}),localStorage.setItem("queue",JSON.stringify(t)))}},{key:"removeFromQueue",value:function(e){if("all"===e)this.setState({queue:[]}),localStorage.removeItem("queue");else{var t=this.state.queue,a=t.findIndex(function(t){return t.key===e});a>=0&&(t.splice(a,1),this.setState({queue:t}),localStorage.setItem("queue",JSON.stringify(t)))}}},{key:"toggleQueue",value:function(){var e=this.state.showQueue;!e?(this.stopPreviewPlaying(),window.gtag("event","viewed queue",{event_category:"navigation"})):window.playerError||this.controlAudio("pause track"),this.updateExplainerState("Queue"),this.setState({showQueue:!e})}},{key:"scrollToTop",value:function(){window.scrollTo({top:0,behavior:"smooth"}),this.setState({scrolledBelowTop:!1})}},{key:"scrolledDown",value:function(){this.setState({scrolledBelowTop:!0})}},{key:"handleToggleAboutModal",value:function(){var e=this.state.aboutModalOpen;this.setState({aboutModalOpen:!e})}},{key:"updateOwnPlaylists",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;return new Promise(function(a,i){e&&t.API.invalidateCache("ownPlaylists",""),t.API.getEntity("ownPlaylists",null).then(function(e){var i=e.items;t.setState({ownPlaylists:i,discoverWeekly:i.find(function(e){return"Discover Weekly"===e.name&&"spotify"===e.owner.id}),releaseRadar:i.find(function(e){return"Release Radar"===e.name&&"spotify"===e.owner.id})},a)})})}},{key:"updateCurrentlyPlaying",value:function(e,t){var a=this;if(a.state.playing&&!e&&t){var i=a.state.queue.findIndex(function(e){return e.id===a.state.playing});i>=0&&a.state.queue.length-1>i&&a.API.getEntity("trackShallow",a.state.queue[i+1].id).then(function(e){a.controlAudio("play track",e.id,e.uri)})}a.setState({playing:e})}},{key:"componentDidMount",value:function(){var e=this,t=this,a=localStorage.getItem("viewedIntroModal");t.handleWindowScroll(),t.setState({viewedIntroModal:a}),t.API.getEntity("own profile","self").then(function(t){e.setState({profile:t})}),t.updateOwnPlaylists().then(function(){var e={readyForExplainer:!0},a=t.state,i=a.ownPlaylists,n=a.discoverWeekly;if(n)t.addToFeed(null,{type:"playlist",id:n.id},!0),t.updateRoot("discover weekly",null,!0);else if(i&&i.length)t.addToFeed(null,{type:"playlist",id:i[0].id}),t.updateRoot("yourPlaylists",null,!0);else{var r=Object(h.getRandomInt)(0,2811);t.API.getEntity("genrePlaylists").then(function(e){var a=e.items.sort(function(e,t){return e.name<t.name?-1:1});t.addToFeed(null,{type:"playlist",id:a[r].id}),t.updateRoot("random genre",null,!0)})}var s=localStorage.getItem("queue");s&&(e.queue=JSON.parse(s)),t.setState(e)})}},{key:"render",value:function(){var e=this,t=this.state,a=t.profile,i=t.viewedIntroModal,r=t.viewedSecondaryModal,s=t.feed,o=t.showQueue,l=t.queue,c=t.playing,d=t.magnifyArtwork,u=t.audioPreview,m=t.showUnplayable,p=t.openLinksInBrowser,h=t.showStats,v=t.numFollowedArtists,f=t.ownPlaylists,y=t.discoverWeekly,g=t.releaseRadar,k=t.currentRootCategory,w=t.currentRootId,b=t.windowHeight,E=t.isScrolledDown,P=t.aboutModalOpen,S=t.showNowPlayingImage,O=t.nowPlayingImages,T=t.captionData,A=t.nowPlayingType,_=t.hoverDeactivated,C=t.readyForExplainer,j=t.explainerFeedShown,N=t.explainerQueueShown,I=t.explainerPlaybackShown,F=a?a.id:n.a.createElement("span",null,"\xa0"),D=a?a.display_name:"",x="";i?i&&!r?x=n.a.createElement(R,{audio:this.controlAudio,handleClose:function(){e.closeModal()}}):P&&(x=n.a.createElement(L,{handleClose:function(){e.handleToggleAboutModal()}})):x=n.a.createElement(R,{audio:this.controlAudio,firstTime:!0,handleClose:function(){e.closeModal()}});var M=S?n.a.createElement(Ie,{images:O,captionData:T,type:A}):"",z=n.a.createElement("div",{className:"logo ".concat(0!==window.scrollY&&this.state.scrolledBelowTop?"logo-scrolled":""),onClick:function(){e.scrollToTop()}}),U=n.a.createElement("span",{className:l.length>0?"active queueButton":"queueButton",onClick:this.toggleQueue},l.length>0?l.length:""),W=h?"You've followed ".concat(v," artist").concat(1!==v?"s":""," and ").concat(this.state.numFollowedPlaylists," playlist").concat(1!==this.state.numFollowedPlaylists?"s":"",", saved ").concat(this.state.numSavedAlbums," album").concat(1!==this.state.numSavedAlbums?"s":""," and ").concat(this.state.numSavedTracks," track").concat(1!==this.state.numSavedTracks?"s":"",", and added ").concat(this.state.numTracksAddedToPlaylists," track").concat(1!==this.state.numTracksAddedToPlaylists?"s":""," to playlists."):"",q=_?n.a.createElement("div",null,n.a.createElement("div",{onClick:function(){e.stopPreviewPlaying()},className:"hide-feed-all"}),n.a.createElement("div",{className:"hide-feed"})):"",B="none";C&&i&&r&&!P&&!o&&(j||S?!I&&S&&_?B="playback":!N&&l.length>0&&!S&&(B="queue"):B="feed");var G=[];return o&&G.push("show-queue"),E&&G.push("header-minimized"),n.a.createElement("div",{id:"app",className:G.join(" ")},x,n.a.createElement("div",{id:"pageHeader"},n.a.createElement("div",{id:"pageHeaderInner"},z,n.a.createElement("div",{id:"pageHeaderRight",className:"info"},n.a.createElement("span",{className:"username"},D),n.a.createElement(Ne,{changeSetting:this.changeSetting,audioPreview:u,showUnplayable:m,openLinksInBrowser:p,magnifyArtwork:d,showStats:h,showAbout:this.handleToggleAboutModal,API:this.API}),U),n.a.createElement("h1",{className:"pageTitle"},"Discover Quickly"))),n.a.createElement(_e,{open:o,toggleQueue:this.toggleQueue,items:l,API:this.API,audio:this.controlAudio,nowPlaying:this.handleNowPlayingImage,hoverDeactivated:_,removeFromQueue:this.removeFromQueue,userId:F,playing:c,ownPlaylists:f,updateOwnPlaylists:this.updateOwnPlaylists,windowHeight:b,incrementStat:this.incrementStat}),n.a.createElement("div",{id:"mainColumn"},n.a.createElement("div",{id:"mainColumnInner"},n.a.createElement(Q,{mode:B}),M,n.a.createElement(H,{API:this.API,addToFeed:this.addToFeed,discoverWeeklyId:y?y.id:"",releaseRadarId:g?g.id:"",currentRootCategory:k,currentRootId:w,updateRoot:this.updateRoot}),n.a.createElement("div",{id:"feed"},q,n.a.createElement(Se,{items:s,API:this.API,audio:this.controlAudio,nowPlaying:this.handleNowPlayingImage,hoverDeactivated:_,showUnplayable:m,addToFeed:this.addToFeed,removeFromFeed:this.removeFromFeed,addToQueue:this.addToQueue,ownPlaylists:f,updateOwnPlaylists:this.updateOwnPlaylists,activateDeactivateHoverAudio:this.activateDeactivateHoverAudio,incrementStat:this.incrementStat,scrolledDown:this.scrolledDown}),n.a.createElement("div",{id:"about",className:"inverted"},"Discover Quickly is a project by ",n.a.createElement("a",{className:"bio-twitter-link",target:"_blank",rel:"noopener noreferrer",href:"https://twitter.com/alizauf"},"Aliza Aufrichtig")," and ",n.a.createElement("a",{className:"bio-twitter-link",target:"_blank",rel:"noopener noreferrer",href:"https://twitter.com/edwrdlee"},"Edward Lee"),".\xa0",n.a.createElement("span",{className:"view-link",onClick:this.handleToggleAboutModal},"Learn more."))))),n.a.createElement("div",{className:"stats-sentence"},W))}}]),t}(i.Component),De=a(50),xe=a.n(De),Re=a(51),Le=a.n(Re),Me=a(52),ze=a.n(Me),Qe=function(e){function t(e){var a;Object(o.a)(this,t),a=Object(c.a)(this,Object(d.a)(t).call(this,e));var i=Object(h.parseWindowLocationHash)().access_token||localStorage.getItem("accessToken");return a.state={readyToAuthorize:i&&i.length>0,windowWidth:window.innerWidth},a.doAuthorize=a.doAuthorize.bind(Object(m.a)(Object(m.a)(a))),a.updateWindowSizes=a.updateWindowSizes.bind(Object(m.a)(Object(m.a)(a))),window.onSpotifyWebPlaybackSDKReady=function(){},window.addEventListener("error",function(e){window.gtag("event",e.message,{event_category:"error",event_label:e.lineno})}),window.addEventListener("resize",function(){a.updateWindowSizes()}),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"doAuthorize",value:function(){this.API=new C}},{key:"updateWindowSizes",value:function(){this.setState({windowWidth:window.innerWidth})}},{key:"render",value:function(){var e=this.state,t=e.readyToAuthorize,a=e.windowWidth;if(t)return n.a.createElement(Fe,null);var i=a>600?n.a.createElement("div",null,n.a.createElement("button",{className:"primaryButton",onClick:this.doAuthorize},"Log in with Spotify")):"",r=a<=600?n.a.createElement("div",null,n.a.createElement("div",{className:"mobile-message"},"Discover Quickly was designed for a desktop experience. Intrigued? ",n.a.createElement("a",{className:"mobile-link",href:"mailto:?subject=Note%20to%20Self%3A%20Check%20out%20Discover%20Quickly%2C%20that%20music%20exploration%20tool%20I%20saw%20on%20the%20internet&body=https%3A%2F%2Fdiscoverquickly.com",target:"_top"},"Email yourself a link")," to check it out on the big screen, or just copy the link and do with it what you will."),n.a.createElement("input",{className:"mobile-input",readOnlytype:"text",value:"https://discoverquickly.com"})):"";return n.a.createElement("div",{className:"opening-screen"},n.a.createElement("div",{className:"logo-opening-screen"}),n.a.createElement("div",{className:"opening-screen-body"},n.a.createElement("h1",null,"Discover Quickly"),n.a.createElement("p",null,"Your interface for music discovery, powered by Spotify."),n.a.createElement("p",{className:"info"},"A project by ",n.a.createElement("a",{className:"intro-name-link",target:"_blank",rel:"noopener noreferrer",href:"https://twitter.com/alizauf"},"Aliza Aufrichtig")," and ",n.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",className:"intro-name-link",href:"https://twitter.com/edwrdlee"},"Edward Lee"),"."),i),n.a.createElement("div",{className:"video-box"},n.a.createElement("img",{className:"browser-chrome",src:xe.a,alt:"browser-chrome"}),n.a.createElement("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0},n.a.createElement("source",{src:ze.a,type:"video/m4v"}),n.a.createElement("source",{src:Le.a,type:"video/mp4"}))),r)}}]),t}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(Qe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[54,2,1]]]);